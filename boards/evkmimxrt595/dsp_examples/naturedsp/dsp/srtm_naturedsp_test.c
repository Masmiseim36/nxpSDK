/*
 * Copyright 2018-2019 NXP
 * All rights reserved.
 *
 * SPDX-License-Identifier: BSD-3-Clause
 */

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <errno.h>

#include "naturedsp_input.h"
#include "fsl_debug_console.h"
#include "srtm_naturedsp_test.h"

/* Signal Processing Library API. */
#include "NatureDSP_Signal.h"

/* Portable data types. */
#include "NatureDSP_types.h"
#include "math.h"

/*******************************************************************************
 * Commands processing for NatureDSP libraries
 ******************************************************************************/
static int tic, toc;
static unsigned long inline get_ccount(void)
{
    unsigned long r;
    __asm__ volatile("rsr.ccount %0" : "=r"(r));
    return r;
}

#define FFT_LENGTH 256
const static int32_t fft_in_ref[FFT_LENGTH] = {
    65536,  65516,  65457,  65358,  65220,  65043,  64827,  64571,  64277,  63944,  63572,  63162,  62714,  62228,
    61705,  61145,  60547,  59914,  59244,  58538,  57798,  57022,  56212,  55369,  54491,  53581,  52639,  51665,
    50660,  49625,  48559,  47465,  46341,  45190,  44012,  42807,  41576,  40320,  39040,  37737,  36410,  35062,
    33693,  32303,  30894,  29466,  28021,  26559,  25080,  23587,  22079,  20558,  19025,  17480,  15925,  14360,
    12786,  11205,  9617,   8023,   6425,   4822,   3217,   1609,   1,      -1607,  -3215,  -4820,  -6423,  -8021,
    -9615,  -11203, -12784, -14358, -15923, -17478, -19023, -20556, -22077, -23585, -25078, -26557, -28019, -29465,
    -30892, -32301, -33691, -35060, -36409, -37735, -39039, -40319, -41575, -42805, -44010, -45189, -46340, -47463,
    -48558, -49623, -50659, -51664, -52638, -53580, -54490, -55367, -56211, -57021, -57797, -58538, -59243, -59913,
    -60547, -61144, -61704, -62228, -62714, -63162, -63572, -63943, -64276, -64571, -64826, -65043, -65220, -65358,
    -65457, -65516, -65536, -65516, -65457, -65359, -65221, -65043, -64827, -64572, -64277, -63944, -63572, -63163,
    -62715, -62229, -61706, -61145, -60548, -59915, -59245, -58539, -57799, -57023, -56213, -55370, -54492, -53583,
    -52640, -51667, -50662, -49626, -48561, -47466, -46343, -45192, -44013, -42808, -41578, -40322, -39042, -37738,
    -36412, -35064, -33694, -32305, -30896, -29468, -28023, -26560, -25082, -23589, -22081, -20560, -19027, -17482,
    -15927, -14362, -12788, -11207, -9619,  -8025,  -6427,  -4824,  -3219,  -1611,  -3,     1605,   3213,   4818,
    6421,   8019,   9613,   11201,  12782,  14356,  15921,  17476,  19021,  20554,  22075,  23583,  25077,  26555,
    28017,  29463,  30891,  32300,  33689,  35059,  36407,  37733,  39037,  40317,  41573,  42804,  44009,  45187,
    46339,  47462,  48557,  49622,  50658,  51663,  52637,  53579,  54489,  55366,  56210,  57020,  57796,  58537,
    59242,  59912,  60546,  61143,  61704,  62227,  62713,  63161,  63571,  63943,  64276,  64571,  64826,  65043,
    65220,  65358,  65457,  65516};

static int32_t fft_out[FFT_LENGTH];
int TEST_FFT()
{
    int i, ret = 0;
    int32_t fft_in[FFT_LENGTH] = {0};
    for (i = 0; i < FFT_LENGTH; i++)
        fft_in[i] = fft_in_ref[i];
    PRINTF("/*FFT TEST START*/\r\n");
    tic = get_ccount();
    fft_real32x32(fft_out, fft_in, rfft32_32, NATUREDSP_FFT_SCALING_OPTION);
    toc = get_ccount();
    for (i = 0; i < FFT_LENGTH; i++)
        if (fft_out[i] != fft_out_ref[i])
        {
            PRINTF("MISMATCH @ %d sample expected %d result %d\r\n", i, fft_out_ref[i], fft_out[i]);
            ret = -1;
        }
    PRINTF("FFT 256 takes %d cycles\r\n", toc - tic);
    PRINTF("/*FFT TEST END with %d*/\r\n\r\n", ret);
    return ret;
}

#define VEC_DOT_LENGTH 16
const static float32_t vec_dot_x[VEC_DOT_LENGTH] = {1.01, 2.02,  3.03,  4.04,  5.05,  6.06,  7.07,  8.08,
                                                    9.09, 10.10, 11.11, 12.12, 13.13, 14.14, 15.15, 16.16};
const static float32_t vec_dot_y[VEC_DOT_LENGTH] = {-1.01, 2.02,  -3.03,  4.04,  -5.05,  6.06,  -7.07,  8.08,
                                                    -9.09, 10.10, -11.11, 12.12, -13.13, 14.14, -15.15, 16.16};
static float32_t vec_dot_out;
const static float32_t vec_dot_out_ref = 138.733643;
int TEST_VEC_DOT()
{
    int ret = 0;
    PRINTF("/*VECTOR DOT TEST START*/\r\n");
    tic         = get_ccount();
    vec_dot_out = vec_dotf(vec_dot_x, vec_dot_y, 16);
    toc         = get_ccount();
    if (fabsf(vec_dot_out - vec_dot_out_ref) > 0.001)
    {
        PRINTF("MISMATCH @ expected %f result %f\r\n", vec_dot_out_ref, vec_dot_out);
        ret = -1;
    }
    PRINTF("VECTOR DOT 16 takes %d cycles\r\n", toc - tic);
    PRINTF("/*VECTOR DOT TEST END with %d */\r\n\r\n", ret);
    return ret;
}

#define VEC_ADD_LENGTH 32
const static int32_t vec_add_x[VEC_ADD_LENGTH] = {
    62509, 36047, 63046, 12585, 23300, 23988, 32632, 23000, 18536, 22183, 47103, 54335, 42283, 47857, 16892, 28633,
    12154, 1942,  24073, 28716, 11429, 16727, 57204, 868,   15556, 24495, 45333, 34344, 49060, 20713, 5719,  12251};
const static int32_t vec_add_y[VEC_ADD_LENGTH] = {
    -1053123987, -1053007554, -1054740687, -1053481038, -1052716707, 1094163531,  1093584928,  1092077273,
    1091998707,  -1053523270, 1094265237,  -1058533236, -1053611710, -1054030307, -1053499989, -1052974933,
    1094111461,  1094643245,  -1053531586, -1056717120, -1056108618, 1089599468,  -1052812287, 1092728688,
    -1053494111, 1090146336,  -1053625130, 1093599993,  -1053641528, -1052940085, -1053162470, 1092828858};
static int32_t vec_add_out[VEC_ADD_LENGTH]           = {};
const static int32_t vec_add_out_ref[VEC_ADD_LENGTH] = {
    -1053061478, -1052971507, -1054677641, -1053468453, -1052693407, 1094187519,  1093617560,  1092100273,
    1092017243,  -1053501087, 1094312340,  -1058478901, -1053569427, -1053982450, -1053483097, -1052946300,
    1094123615,  1094645187,  -1053507513, -1056688404, -1056097189, 1089616195,  -1052755083, 1092729556,
    -1053478555, 1090170831,  -1053579797, 1093634337,  -1053592468, -1052919372, -1053156751, 1092841109};
int TEST_VEC_ADD()
{
    int i, ret = 0;
    PRINTF("/*VECTOR ADD TEST START*/\r\n");
    tic = get_ccount();
    vec_add32x32_fast(vec_add_out, vec_add_x, vec_add_y, 32);
    toc = get_ccount();
    for (i = 0; i < VEC_ADD_LENGTH; i++)
        if (vec_add_out[i] != vec_add_out_ref[i])
        {
            PRINTF("MISMATCH @ %d sample expected %d result %d\r\n", i, vec_add_out_ref[i], vec_add_out[i]);
            ret = -1;
        }
    PRINTF("VECTOR ADD 32 takes %d cycles\r\n", toc - tic);
    PRINTF("/*VECTOR ADD TEST END with %d */\r\n\r\n", ret);
    return ret;
}

#define VEC_MAX_LENGTH 1024
const static float32_t vec_max[VEC_MAX_LENGTH] = {
    1966.132,  3423.486,  -4163.269, 5124.679,  2430.980,  3147.687,  -30.603,   4597.390,  -4040.610, 1001.885,
    6134.337,  2264.513,  2818.826,  3542.197,  506.927,   -445.104,  -3908.078, -1559.036, -2200.345, 978.809,
    -2848.442, 2449.120,  -1484.255, -2114.089, -5308.668, -5402.082, -1413.053, 2170.853,  4709.438,  3229.255,
    -2893.607, 52.692,    -4172.154, -910.198,  -1155.641, -5562.872, -2721.710, -3787.146, 2450.971,  5982.926,
    -1559.406, -826.657,  -4354.786, 2126.922,  231.498,   53.185,    3693.239,  1282.990,  -6086.705, 2528.589,
    -3184.954, 1153.050,  1003.736,  2273.645,  -1032.981, -736.698,  336.512,   -2575.852, -1018.914, 4607.016,
    -1961.566, 3055.384,  -2498.973, 1927.508,  -2436.410, 2583.009,  -1780.415, -2268.956, -5862.734, 556.411,
    -2823.515, -1554.223, 3170.763,  499.647,   -2427.648, 829.125,   -2036.470, 2076.082,  5256.346,  -3868.713,
    4609.730,  516.306,   -3320.324, -3424.967, 3826.264,  6084.360,  -2898.789, -894.156,  3745.437,  -3002.939,
    -4098.978, -1389.731, 2566.843,  3663.746,  1398.122,  4607.386,  -2690.737, -1646.650, 5671.834,  3950.157,
    6099.292,  -1228.817, 4578.880,  -6050.549, -5403.439, 1110.723,  -1911.466, 4008.032,  4276.797,  4512.861,
    4113.045,  -6069.552, 4300.120,  2537.598,  -4541.490, -5722.675, -192.751,  1348.885,  5925.421,  5983.296,
    2486.633,  2367.676,  -4946.736, -3186.311, -2838.817, 2683.950,  -4720.050, 1840.264,  5622.351,  -2328.064,
    1514.488,  -796.300,  -3884.509, -5573.978, 1127.876,  -3016.266, 3415.465,  583.188,   -1418.730, 73.670,
    -3651.653, 4305.796,  -4443.881, -1328.031, -4061.711, -1222.524, 3354.999,  -898.352,  4098.237,  1079.256,
    -2173.444, -4231.386, 3604.391,  5662.456,  1069.631,  4084.910,  -3273.432, 2702.460,  -5223.028, 3097.957,
    5698.982,  -1116.523, 4241.258,  220.516,   1147.867,  -2787.606, -3466.923, -4675.626, -5503.640, 986.706,
    17.523,    5995.389,  5165.524,  5805.600,  -749.778,  4409.205,  -3559.103, 3132.632,  -1823.975, -4146.240,
    -812.589,  -5669.613, 3909.559,  2452.452,  -856.273,  -4318.260, 4146.487,  4845.671,  4857.641,  57.998,
    -1663.679, -2872.382, 3219.383,  -110.320,  5468.965,  -5783.758, -289.373,  -3858.471, 5428.736,  1230.792,
    -2764.777, 4789.154,  -3248.752, -610.213,  -5092.718, 752.123,   1017.433,  -2381.003, -284.560,  -3338.217,
    1218.328,  -2671.240, -1915.908, -3608.216, 3793.439,  -2868.310, 696.470,   -3314.154, -2265.624, 4163.146,
    4279.389,  3225.059,  -6028.213, -3513.321, -2812.286, 4517.304,  -3156.942, 648.467,   467.316,   -5013.372,
    -5228.952, -5251.287, 4209.421,  3599.825,  -4492.377, -2819.320, 623.540,   -5530.418, 1445.878,  -4361.573,
    -491.502,  -5037.682, -2088.298, -1385.042, -4269.763, 80.704,    5272.635,  -3331.553, 3968.667,  -5496.853,
    -5075.442, 2260.194,  -1765.360, -3778.385, 978.562,   -5246.968, -2887.066, 417.832,   1401.701,  3233.944,
    -992.876,  750.149,   2924.827,  -3533.559, 3017.500,  -5709.471, -1254.238, 2274.509,  5499.074,  -3329.702,
    -1837.796, 4144.142,  -4330.106, -5125.172, -232.486,  2658.776,  212.125,   -3019.845, -238.039,  3715.204,
    3486.790,  1051.368,  -3411.640, 3273.555,  4708.204,  793.462,   2897.062,  5558.923,  -429.432,  -2319.426,
    4123.288,  3801.954,  -1762.275, -256.055,  1023.973,  -2205.035, -4726.097, -2874.109, -2375.327, -5550.285,
    -4588.382, -166.343,  2952.222,  -1888.637, 1292.121,  1376.280,  -5599.275, -2347.315, 693.014,   -6029.077,
    -419.930,  874.659,   -1020.271, -2231.442, -690.546,  5274.486,  3750.743,  -894.773,  543.824,   732.502,
    2998.867,  4166.848,  1979.953,  192.874,   -2426.044, -2048.687, -629.834,  -4559.507, 4665.384,  218.048,
    -5553.370, 3575.885,  3782.210,  -2738.369, 1521.522,  5227.224,  -2379.646, 1870.867,  282.956,   1629.991,
    -3238.880, -481.507,  1867.042,  3656.836,  -1907.394, 2701.103,  2972.459,  3582.425,  -6084.607, -3652.517,
    2304.372,  2751.080,  -4233.484, 5079.761,  2708.507,  -1386.399, 954.746,   4005.317,  -6066.221, -4066.277,
    1967.366,  -1699.341, 4962.531,  2145.803,  -5280.409, -4888.121, 1203.644,  3731.986,  -4503.977, 1514.241,
    3272.074,  3401.398,  34.182,    4554.941,  -4935.383, -3626.603, 2123.961,  2811.299,  4083.553,  -3316.622,
    1135.403,  2261.182,  -1973.906, -2290.674, 321.087,   2320.414,  1648.994,  2639.649,  -4408.712, 811.355,
    -11.600,   -4718.939, -5352.352, 233.966,   3561.201,  4659.954,  -2917.423, 4143.402,  59.726,    3423.980,
    -5286.950, 3201.983,  -3257.143, 3141.024,  -4171.660, -3287.499, -4512.738, 4235.458,  -508.038,  -3575.638,
    1412.560,  -3677.073, -2363.480, -5074.702, -5423.553, 2689.133,  6119.159,  -85.886,   -5042.988, 192.257,
    5533.503,  -1676.512, -670.432,  5149.235,  -3886.360, -2666.551, 4565.800,  4811.613,  137.961,   419.313,
    212.001,   -2484.289, -2224.285, -1162.551, 3963.485,  -2299.806, 3035.146,  -3038.231, -5193.166, -2287.096,
    -760.144,  1756.229,  -4142.538, 3382.888,  5325.327,  5500.061,  -2429.623, -4173.511, -1135.774, 4356.020,
    1754.254,  5047.430,  -5924.064, -6039.813, 1694.035,  -4629.845, 5664.677,  -2958.021, -6042.034, 3689.290,
    -1075.308, -5101.726, 5105.922,  2552.159,  4880.964,  -5367.160, -4842.586, 3273.679,  2416.172,  -3129.301,
    -756.936,  -5571.263, -995.468,  -1152.556, -5122.334, -4613.186, 3051.929,  -4737.820, 4703.268,  -6023.771,
    820.240,   -6018.588, 1164.279,  3709.157,  -3802.818, 2604.974,  214.963,   -77.248,   -2393.466, -5593.599,
    6030.805,  -4367.743, -4876.768, 329.601,   -2840.791, 4777.678,  -557.645,  -2630.888, -3234.191, 5155.035,
    4072.200,  5558.676,  5162.069,  -3891.049, -1868.523, -4908.112, 1009.165,  -3866.616, -3767.649, -5398.256,
    -5713.050, 1661.334,  113.775,   5245.857,  -3591.804, -783.837,  1969.094,  2323.745,  4062.205,  -4749.419,
    5811.153,  -464.971,  1507.948,  -3674.482, -242.111,  1062.351,  -5250.423, 4753.615,  -3488.765, -990.162,
    3103.757,  -5982.802, -1058.402, 3875.007,  -1393.926, 2706.902,  3621.790,  5063.719,  -3970.395, -2328.805,
    -1978.842, -5747.232, -720.039,  5525.235,  4122.054,  -720.162,  3316.128,  5831.637,  5383.202,  718.311,
    1089.499,  5402.082,  5210.442,  -3674.112, -2763.666, 4744.853,  -5548.434, 1831.009,  4519.525,  -3531.831,
    4987.705,  -1409.845, 4774.099,  -12.710,   -5328.412, -4062.575, -1484.996, -3850.450, -2831.413, -4112.428,
    -2686.665, -3652.393, -903.782,  5464.029,  3749.139,  -1853.962, -2312.393, 4482.752,  -4752.011, -4531.001,
    2477.132,  -1633.693, 5842.003,  -2628.790, 4569.872,  -4960.063, 3988.041,  -2236.625, 1102.949,  3988.288,
    1327.414,  -4511.627, -4530.261, 3056.741,  -3143.368, -2362.370, 6153.711,  995.098,   5253.138,  -1915.291,
    4475.348,  3003.309,  174.117,   -3306.380, 462.256,   -2063.495, 2834.498,  -3972.246, 4428.086,  5570.523,
    -5602.854, -4046.533, -2829.439, -5285.469, 1156.998,  4319.864,  4110.701,  -129.817,  2062.878,  -1436.746,
    767.301,   6151.984,  -2345.834, 1215.860,  -3055.507, -191.393,  -5061.374, 334.537,   -1977.608, -3847.489,
    -4363.918, 3248.875,  713.869,   801.236,   3981.748,  -5646.414, 3397.325,  -2843.876, -5042.247, -125.498,
    1762.522,  207.806,   3580.451,  -5356.054, -5418.741, -3019.104, 3905.733,  -2786.125, 1753.884,  -2728.497,
    -5846.075, -1988.591, 1406.390,  -3384.122, 3790.231,  -3720.633, -19.744,   1297.304,  -5073.221, 5728.475,
    -2803.771, -5481.181, 239.396,   106.864,   -4251.624, -2739.480, 4585.914,  -996.825,  -1693.295, 2843.753,
    3360.922,  -2621.386, 3442.737,  -1828.171, -2804.759, -5328.782, -1481.787, -2414.691, -111.307,  -3315.635,
    -3795.167, 1997.106,  -2938.648, 1559.159,  1703.167,  -2504.526, -4707.710, -4741.398, -1087.524, 3960.523,
    2504.033,  5772.405,  -328.614,  2873.616,  -1898.015, -3144.849, -4826.544, -4435.366, 4251.500,  3770.240,
    4922.179,  4761.142,  -5579.531, -348.605,  -4678.217, 346.631,   1524.360,  690.423,   -2579.430, -5235.985,
    4969.318,  -4298.269, -4042.831, -2937.167, -5863.598, 3349.570,  1060.129,  -2825.860, -4326.157, 5843.360,
    1182.789,  2949.507,  -3185.077, 2362.493,  -4008.155, -1099.494, 5249.930,  -40.845,   4484.603,  -2374.216,
    4034.810,  -5960.220, -1113.438, -3439.775, 4205.842,  3674.605,  -697.210,  -4725.850, 4046.780,  700.912,
    4375.641,  -4447.830, -4994.492, 5863.968,  3822.315,  -1814.474, 2239.463,  -3835.642, -541.973,  -83.172,
    -759.527,  4970.799,  -1612.344, 3265.904,  1361.842,  573.193,   -3911.286, -5843.854, 3.085,     -1819.533,
    -2669.265, -6014.639, -4402.542, 3440.269,  516.059,   3419.044,  2559.193,  2388.530,  -4180.422, 3445.081,
    4853.939,  2603.370,  -6077.080, -640.693,  773.595,   288.016,   -3765.551, -2576.592, 5047.800,  -2194.792,
    -5962.688, 2353.238,  2379.029,  3179.031,  -4025.925, -1694.159, -541.232,  -2746.390, 3462.974,  4112.428,
    -2215.894, -5568.425, 212.618,   2351.634,  -2849.183, -5007.819, -621.813,  3513.445,  3555.277,  -645.876,
    -4340.842, -636.867,  -3075.868, 4011.734,  -3726.433, -5883.465, -352.307,  2458.375,  -1081.478, 5038.792,
    -3165.580, -4228.424, 4600.105,  -4897.623, -2837.089, 5505.244,  -3771.474, 6147.418,  26.284,    -228.290,
    -2887.190, 748.915,   1022.616,  -4258.411, -1659.853, -4929.213, -2195.903, -5845.581, -1768.569, 941.419,
    648.097,   -3725.323, 3115.850,  3451.498,  -5720.207, -4517.551, -5788.694, -521.488,  4141.798,  -2219.102,
    3203.217,  1277.560,  347.494,   -225.328,  4909.222,  -5588.046, 4122.424,  4690.187,  -383.280,  -5151.210,
    2994.054,  -4036.414, -5398.873, -1246.957, -4210.161, -5934.800, -3819.353, 2100.638,  -808.393,  2820.060,
    -917.602,  -5585.207, -238.902,  -1381.833, -731.392,  -3129.054, -4724.863, -4558.519, -5362.100, 4710.055,
    -3581.562, 3844.157,  -144.008,  -2047.946, -80.457,   -5418.617, -4162.899, 5369.134,  -209.533,  -4689.570,
    2525.504,  -3970.765, 6032.162,  -4056.405, -3334.268, -5818.927, -3443.477, 1939.478,  -3078.953, -2909.895,
    5938.748,  1940.959,  71.325,    -2525.258, 6069.182,  1058.032,  993.123,   -612.311,  5418.000,  -2922.976,
    -3912.767, 3935.349,  3235.425,  -272.714,  -244.826,  -2770.577, 4659.954,  -3514.802, -2712.702, 5669.119,
    -5621.117, -4677.107, -3901.168, -3551.205, 222.984,   -465.835,  -2382.360, 5235.122,  437.700,   4995.602,
    -910.939,  2473.800,  2948.026,  671.049,   439.798,   4182.643,  -1290.641, 132.902,   -1120.842, 4717.829,
    3160.891,  2049.674,  3174.465,  -3777.891, 5789.188,  4833.701,  -5391.840, 4399.580,  -3252.824, -3899.687,
    2127.910,  -1331.609, 5417.877,  -4180.422, -5358.398, -4037.648, 5747.972,  3870.811,  -3435.703, -4606.522,
    912.666,   -6126.687, 1473.766,  -5766.976, 4299.009,  514.948,   -5339.395, -3596.863, -242.604,  5180.455,
    4672.171,  900.573,   -2072.997, 4188.073,  -4195.847, -2182.823, -2605.714, 2699.128,  -6138.163, 5345.194,
    -4301.354, 1663.185,  5512.772,  -6116.074, -5796.221, 2395.811,  -5852.739, 3142.628,  4757.934,  -847.141,
    549.747,   -1568.167, -5115.177, 6010.074,  -1568.291, -2916.682, 700.665,   -653.033,  5164.907,  5067.668,
    -1693.912, -5648.635, 4615.283,  -3649.432, -3262.079, -5887.784, -3541.703, -2378.658, -5686.766, -4448.693,
    6072.514,  179.300,   -1786.462, 599.477,   -1412.560, 3578.847,  -1214.873, 2709.741,  -3812.320, -3543.184,
    -696.346,  6046.970,  4921.439,  4687.226,  1417.496,  -2738.246, -5498.457, 465.218,   3697.187,  5773.392,
    86.503,    -425.977,  -1592.230, -4211.025};
static float32_t vec_max_out;
const static float32_t vec_max_out_ref = 6153.711;
int TEST_VEC_MAX()
{
    int ret = 0;
    PRINTF("/*VECTOR MAX TEST START*/\r\n");
    tic         = get_ccount();
    vec_max_out = vec_maxf(vec_max, 1024);
    toc         = get_ccount();
    if (vec_max_out != vec_max_out_ref)
    {
        PRINTF("MISMATCH @ expected %f result %f\r\n", vec_max_out_ref, vec_max_out);
        ret = -1;
    }
    PRINTF("VECTOR MAX 1024f takes %d cycles\r\n", toc - tic);
    PRINTF("/*VECTOR MAX TEST END with %d */\r\n\r\n", ret);
    return ret;
}

#define IIR_LENGTH 1024
const static int32_t iir_x[IIR_LENGTH] = {
    1073741824,  1073721611,  1073660973,  1073559912,  1073418433,  1073236539,  1073014240,  1072751541,  1072448454,
    1072104991,  1071721163,  1071296985,  1070832474,  1070327646,  1069782521,  1069197120,  1068571463,  1067905576,
    1067199483,  1066453210,  1065666786,  1064840240,  1063973603,  1063066908,  1062120190,  1061133483,  1060106826,
    1059040255,  1057933813,  1056787540,  1055601479,  1054375676,  1053110176,  1051805027,  1050460278,  1049075980,
    1047652185,  1046188947,  1044686319,  1043144360,  1041563128,  1039942681,  1038283080,  1036584389,  1034846672,
    1033069992,  1031254419,  1029400019,  1027506863,  1025575021,  1023604568,  1021595576,  1019548122,  1017462282,
    1015338136,  1013175762,  1010975244,  1008736662,  1006460102,  1004145650,  1001793392,  999403417,   996975815,
    994510677,   992008097,   989468168,   986890986,   984276648,   981625253,   978936900,   976211691,   973449728,
    970651115,   967815958,   964944363,   962036438,   959092294,   956112040,   953095789,   950043654,   946955751,
    943832195,   940673105,   937478599,   934248797,   930983821,   927683795,   924348841,   920979087,   917574658,
    914135683,   910662291,   907154613,   903612782,   900036930,   896427192,   892783704,   889106603,   885396028,
    881652118,   877875015,   874064860,   870221797,   866345970,   862437526,   858496612,   854523376,   850517968,
    846480538,   842411239,   838310223,   834177646,   830013662,   825818428,   821592103,   817334846,   813046816,
    808728176,   804379087,   799999714,   795590221,   791150775,   786681543,   782182692,   777654393,   773096815,
    768510131,   763894513,   759250135,   754577171,   749875798,   745146192,   740388532,   735602997,   730789767,
    725949023,   721080948,   716185724,   711263536,   706314570,   701339011,   696337047,   691308867,   686254659,
    681174614,   676068923,   670937779,   665781374,   660599903,   655393561,   650162543,   644907047,   639627271,
    634323413,   628995673,   623644252,   618269352,   612871173,   607449921,   602005798,   596539010,   591049763,
    585538263,   580004717,   574449335,   568872326,   563273898,   557654264,   552013634,   546352221,   540670239,
    534967900,   529245420,   523503015,   517740900,   511959292,   506158409,   500338470,   494499693,   488642298,
    482766507,   476872539,   470960618,   465030965,   459083804,   453119359,   447137854,   441139515,   435124566,
    429093236,   423045751,   416982338,   410903226,   404808644,   398698821,   392573987,   386434373,   380280210,
    374111730,   367929164,   361732746,   355522709,   349299287,   343062714,   336813225,   330551055,   324276440,
    317989617,   311690821,   305380290,   299058261,   292724974,   286380665,   280025574,   273659941,   267284004,
    260898005,   254502182,   248096778,   241682033,   235258189,   228825487,   222384171,   215934481,   209476662,
    203010957,   196537608,   190056859,   183568955,   177074140,   170572658,   164064754,   157550673,   151030660,
    144504961,   137973822,   131437487,   124896205,   118350220,   111799779,   105245129,   98686517,    92124189,
    85558393,    78989376,    72417384,    65842666,    59265470,    52686041,    46104630,    39521482,    32936847,
    26350971,    19764104,    13176492,    6588384,     28,          -6588327,    -13176434,   -19764046,   -26350914,
    -32936789,   -39521425,   -46104572,   -52685984,   -59265412,   -65842609,   -72417327,   -78989318,   -85558336,
    -92124132,   -98686460,   -105245072,  -111799722,  -118350163,  -124896148,  -131437430,  -137973764,  -144504904,
    -151030603,  -157550616,  -164064697,  -170572601,  -177074083,  -183568898,  -190056802,  -196537551,  -203010900,
    -209476606,  -215934425,  -222384114,  -228825431,  -235258133,  -241681977,  -248096722,  -254502126,  -260897949,
    -267283949,  -273659885,  -280025519,  -286380610,  -292724918,  -299058206,  -305380235,  -311690766,  -317989562,
    -324276386,  -330551001,  -336813171,  -343062660,  -349299233,  -355522655,  -361732692,  -367929110,  -374111676,
    -380280156,  -386434319,  -392573933,  -398698767,  -404808591,  -410903173,  -416982285,  -423045698,  -429093183,
    -435124514,  -441139462,  -447137802,  -453119307,  -459083752,  -465030913,  -470960566,  -476872488,  -482766455,
    -488642247,  -494499642,  -500338419,  -506158358,  -511959241,  -517740849,  -523502964,  -529245370,  -534967850,
    -540670189,  -546352172,  -552013585,  -557654215,  -563273849,  -568872277,  -574449287,  -580004669,  -585538214,
    -591049714,  -596538962,  -602005750,  -607449873,  -612871126,  -618269305,  -623644206,  -628995627,  -634323367,
    -639627225,  -644907001,  -650162497,  -655393515,  -660599858,  -665781329,  -670937734,  -676068879,  -681174570,
    -686254615,  -691308823,  -696337004,  -701338968,  -706314527,  -711263493,  -716185681,  -721080905,  -725948981,
    -730789725,  -735602955,  -740388491,  -745146151,  -749875757,  -754577130,  -759250094,  -763894473,  -768510091,
    -773096775,  -777654353,  -782182653,  -786681504,  -791150736,  -795590183,  -799999676,  -804379049,  -808728138,
    -813046778,  -817334808,  -821592066,  -825818391,  -830013625,  -834177609,  -838310187,  -842411203,  -846480503,
    -850517933,  -854523341,  -858496578,  -862437492,  -866345936,  -870221763,  -874064826,  -877874981,  -881652085,
    -885395995,  -889106571,  -892783672,  -896427160,  -900036898,  -903612751,  -907154582,  -910662260,  -914135653,
    -917574628,  -920979057,  -924348812,  -927683766,  -930983793,  -934248769,  -937478571,  -940673077,  -943832168,
    -946955724,  -950043627,  -953095762,  -956112014,  -959092268,  -962036413,  -964944338,  -967815933,  -970651091,
    -973449704,  -976211667,  -978936877,  -981625230,  -984276625,  -986890963,  -989468145,  -992008075,  -994510655,
    -996975793,  -999403395,  -1001793371, -1004145629, -1006460082, -1008736642, -1010975224, -1013175743, -1015338117,
    -1017462264, -1019548104, -1021595558, -1023604550, -1025575004, -1027506846, -1029400002, -1031254403, -1033069977,
    -1034846656, -1036584374, -1038283066, -1039942666, -1041563114, -1043144347, -1044686306, -1046188934, -1047652173,
    -1049075968, -1050460266, -1051805016, -1053110165, -1054375665, -1055601469, -1056787530, -1057933803, -1059040246,
    -1060106816, -1061133474, -1062120182, -1063066900, -1063973595, -1064840232, -1065666778, -1066453203, -1067199476,
    -1067905570, -1068571458, -1069197114, -1069782516, -1070327641, -1070832469, -1071296981, -1071721159, -1072104987,
    -1072448452, -1072751539, -1073014237, -1073236538, -1073418431, -1073559911, -1073660972, -1073721610, -1073741823,
    -1073721611, -1073660973, -1073559913, -1073418434, -1073236541, -1073014242, -1072751544, -1072448457, -1072104994,
    -1071721166, -1071296989, -1070832478, -1070327651, -1069782526, -1069197125, -1068571469, -1067905582, -1067199489,
    -1066453216, -1065666793, -1064840247, -1063973611, -1063066917, -1062120198, -1061133492, -1060106835, -1059040265,
    -1057933823, -1056787550, -1055601490, -1054375687, -1053110187, -1051805039, -1050460290, -1049075993, -1047652198,
    -1046188959, -1044686333, -1043144374, -1041563142, -1039942695, -1038283095, -1036584404, -1034846687, -1033070008,
    -1031254435, -1029400035, -1027506879, -1025575038, -1023604585, -1021595594, -1019548140, -1017462301, -1015338155,
    -1013175781, -1010975263, -1008736682, -1006460122, -1004145670, -1001793412, -999403438,  -996975836,  -994510699,
    -992008119,  -989468190,  -986891009,  -984276671,  -981625277,  -978936924,  -976211715,  -973449753,  -970651140,
    -967815983,  -964944388,  -962036464,  -959092320,  -956112066,  -953095815,  -950043681,  -946955778,  -943832223,
    -940673133,  -937478627,  -934248825,  -930983850,  -927683824,  -924348871,  -920979116,  -917574688,  -914135713,
    -910662321,  -907154644,  -903612813,  -900036961,  -896427223,  -892783736,  -889106635,  -885396060,  -881652151,
    -877875048,  -874064893,  -870221830,  -866346004,  -862437561,  -858496647,  -854523411,  -850518003,  -846480574,
    -842411274,  -838310259,  -834177682,  -830013698,  -825818465,  -821592140,  -817334883,  -813046854,  -808728213,
    -804379125,  -799999752,  -795590260,  -791150814,  -786681582,  -782182732,  -777654433,  -773096855,  -768510171,
    -763894553,  -759250175,  -754577212,  -749875839,  -745146234,  -740388574,  -735603039,  -730789809,  -725949066,
    -721080991,  -716185767,  -711263580,  -706314613,  -701339055,  -696337091,  -691308911,  -686254703,  -681174659,
    -676068968,  -670937824,  -665781419,  -660599948,  -655393606,  -650162589,  -644907093,  -639627317,  -634323460,
    -628995720,  -623644299,  -618269399,  -612871220,  -607449968,  -602005845,  -596539058,  -591049811,  -585538311,
    -580004766,  -574449384,  -568872374,  -563273947,  -557654313,  -552013683,  -546352271,  -540670288,  -534967950,
    -529245470,  -523503065,  -517740950,  -511959342,  -506158460,  -500338521,  -494499744,  -488642350,  -482766558,
    -476872591,  -470960670,  -465031017,  -459083856,  -453119411,  -447137906,  -441139567,  -435124619,  -429093289,
    -423045804,  -416982391,  -410903279,  -404808697,  -398698874,  -392574041,  -386434427,  -380280264,  -374111784,
    -367929218,  -361732801,  -355522764,  -349299342,  -343062769,  -336813280,  -330551110,  -324276495,  -317989672,
    -311690876,  -305380345,  -299058317,  -292725029,  -286380721,  -280025630,  -273659997,  -267284060,  -260898060,
    -254502238,  -248096834,  -241682089,  -235258245,  -228825544,  -222384227,  -215934538,  -209476719,  -203011013,
    -196537664,  -190056916,  -183569012,  -177074196,  -170572714,  -164064810,  -157550729,  -151030717,  -144505018,
    -137973879,  -131437545,  -124896262,  -118350277,  -111799837,  -105245187,  -98686574,   -92124247,   -85558450,
    -78989433,   -72417442,   -65842724,   -59265527,   -52686099,   -46104687,   -39521540,   -32936904,   -26351029,
    -19764161,   -13176549,   -6588442,    -86,         6588269,     13176377,    19763989,    26350856,    32936732,
    39521367,    46104515,    52685927,    59265355,    65842551,    72417269,    78989261,    85558278,    92124075,
    98686402,    105245015,   111799665,   118350106,   124896091,   131437373,   137973707,   144504847,   151030546,
    157550559,   164064640,   170572544,   177074026,   183568842,   190056746,   196537494,   203010844,   209476550,
    215934369,   222384058,   228825375,   235258077,   241681921,   248096666,   254502070,   260897893,   267283893,
    273659830,   280025463,   286380554,   292724863,   299058151,   305380179,   311690711,   317989507,   324276331,
    330550946,   336813116,   343062605,   349299179,   355522601,   361732638,   367929056,   374111622,   380280102,
    386434266,   392573880,   398698714,   404808537,   410903120,   416982232,   423045645,   429093131,   435124461,
    441139410,   447137749,   453119255,   459083700,   465030861,   470960514,   476872436,   482766404,   488642196,
    494499591,   500338368,   506158307,   511959191,   517740799,   523502914,   529245320,   534967800,   540670139,
    546352122,   552013535,   557654165,   563273800,   568872228,   574449238,   580004620,   585538166,   591049666,
    596538914,   602005702,   607449826,   612871079,   618269257,   623644159,   628995580,   634323320,   639627179,
    644906955,   650162451,   655393469,   660599812,   665781284,   670937689,   676068834,   681174525,   686254571,
    691308779,   696336960,   701338924,   706314483,   711263450,   716185638,   721080863,   725948939,   730789683,
    735602914,   740388449,   745146109,   749875715,   754577089,   759250053,   763894432,   768510051,   773096736,
    777654314,   782182613,   786681465,   791150698,   795590144,   799999637,   804379011,   808728100,   813046741,
    817334771,   821592029,   825818355,   830013589,   834177573,   838310151,   842411167,   846480467,   850517898,
    854523307,   858496543,   862437458,   866345902,   870221729,   874064793,   877874948,   881652052,   885395963,
    889106538,   892783640,   896427128,   900036867,   903612719,   907154552,   910662230,   914135622,   917574598,
    920979028,   924348783,   927683737,   930983764,   934248740,   937478543,   940673049,   943832140,   946955696,
    950043600,   953095736,   956111987,   959092242,   962036387,   964944313,   967815908,   970651066,   973449680,
    976211643,   978936853,   981625207,   984276602,   986890941,   989468123,   992008053,   994510634,   996975772,
    999403374,   1001793350,  1004145609,  1006460062,  1008736623,  1010975205,  1013175724,  1015338098,  1017462246,
    1019548086,  1021595541,  1023604533,  1025574987,  1027506829,  1029399986,  1031254387,  1033069961,  1034846641,
    1036584359,  1038283051,  1039942652,  1041563100,  1043144333,  1044686293,  1046188921,  1047652160,  1049075956,
    1050460255,  1051805004,  1053110154,  1054375654,  1055601458,  1056787520,  1057933793,  1059040236,  1060106807,
    1061133466,  1062120173,  1063066892,  1063973588,  1064840225,  1065666771,  1066453196,  1067199470,  1067905564,
    1068571452,  1069197109,  1069782511,  1070327637,  1070832465,  1071296977,  1071721156,  1072104984,  1072448449,
    1072751536,  1073014235,  1073236536,  1073418430,  1073559910,  1073660971,  1073721610};
static int32_t iir_out[IIR_LENGTH]           = {};
const static int32_t iir_out_ref[IIR_LENGTH] = {
    0,      755,    4819,   12168,  16900,  15802,  13832,  14830,  15499,  14570,  14598,  15270,  14854,  14477,
    15132,  15008,  14432,  14972,  15118,  14428,  14811,  15165,  14477,  14642,  15162,  14554,  14487,  15106,
    14646,  14358,  15001,  14737,  14266,  14854,  14810,  14215,  14679,  14851,  14203,  14491,  14849,  14225,
    14305,  14799,  14268,  14136,  14701,  14320,  13994,  14560,  14365,  13886,  14384,  14390,  13816,  14186,
    14382,  13780,  13979,  14334,  13772,  13777,  14242,  13780,  13593,  14106,  13791,  13437,  13931,  13793,
    13313,  13728,  13773,  13222,  13507,  13721,  13161,  13282,  13630,  13122,  13065,  13498,  13096,  12866,
    13327,  13069,  12694,  13123,  13030,  12552,  12894,  12968,  12441,  12653,  12874,  12355,  12411,  12743,
    12287,  12179,  12575,  12227,  11966,  12372,  12164,  11779,  12141,  12086,  11620,  11890,  11985,  11488,
    11630,  11853,  11378,  11372,  11687,  11282,  11126,  11486,  11190,  10901,  11254,  11092,  10701,  10998,
    10978,  10526,  10728,  10840,  10374,  10453,  10673,  10241,  10182,  10474,  10118,  9925,   10245,  9996,
    9688,   9989,   9866,   9474,   9713,   9719,   9284,   9426,   9549,   9114,   9138,   9350,   8959,   8857,
    9123,   8811,   8590,   8869,   8662,   8342,   8593,   8503,   8116,   8301,   8327,   7911,   8002,   8128,
    7724,   7703,   7904,   7549,   7413,   7653,   7379,   7138,   7378,   7206,   6882,   7085,   7022,   6646,
    6780,   6820,   6429,   6471,   6597,   6227,   6165,   6350,   6035,   5869,   6080,   5845,   5589,   5790,
    5650,   5326,   5485,   5444,   5082,   5171,   5222,   4855,   4855,   4979,   4641,   4545,   4714,   4434,
    4246,   4429,   4228,   3962,   4128,   4016,   3695,   3814,   3793,   3446,   3494,   3553,   3212,   3176,
    3294,   2989,   2864,   3016,   2771,   2565,   2721,   2551,   2281,   2412,   2325,   2014,   2094,   2088,
    1762,   1773,   1835,   1523,   1456,   1565,   1293,   1147,   1279,   1066,   850,    978,    838,    568,
    666,    603,    302,    348,    356,    50,     30,     95,     -191,   -283,   -181,   -424,   -587,   -472,
    -655,   -878,   -774,   -889,   -1155,  -1084,  -1130,  -1417,  -1398,  -1382,  -1666,  -1710,  -1646,  -1906,
    -2016,  -1923,  -2139,  -2312,  -2213,  -2371,  -2595,  -2512,  -2606,  -2864,  -2817,  -2848,  -3119,  -3123,
    -3100,  -3362,  -3426,  -3363,  -3597,  -3721,  -3638,  -3827,  -4005,  -3923,  -4056,  -4276,  -4215,  -4289,
    -4534,  -4510,  -4528,  -4779,  -4804,  -4777,  -5014,  -5093,  -5035,  -5241,  -5374,  -5303,  -5464,  -5644,
    -5578,  -5687,  -5901,  -5858,  -5914,  -6145,  -6139,  -6147,  -6377,  -6418,  -6388,  -6600,  -6690,  -6637,
    -6817,  -6953,  -6893,  -7030,  -7206,  -7154,  -7244,  -7446,  -7418,  -7461,  -7674,  -7682,  -7683,  -7891,
    -7942,  -7911,  -8100,  -8195,  -8146,  -8303,  -8439,  -8386,  -8503,  -8671,  -8631,  -8703,  -8891,  -8877,
    -8906,  -9100,  -9120,  -9114,  -9299,  -9358,  -9327,  -9490,  -9588,  -9545,  -9677,  -9808,  -9767,  -9861,
    -10017, -9990,  -10046, -10215, -10213, -10232, -10403, -10432, -10422, -10582, -10645, -10616, -10754, -10850,
    -10813, -10921, -11045, -11012, -11086, -11230, -11211, -11251, -11404, -11409, -11417, -11568, -11602, -11586,
    -11724, -11788, -11757, -11874, -11966, -11930, -12019, -12135, -12104, -12161, -12293, -12278, -12303, -12440,
    -12449, -12446, -12578, -12614, -12591, -12708, -12772, -12738, -12832, -12921, -12886, -12952, -13060, -13033,
    -13070, -13189, -13178, -13188, -13308, -13319, -13306, -13418, -13454, -13425, -13521, -13581, -13545, -13618,
    -13699, -13665, -13712, -13807, -13783, -13804, -13906, -13897, -13895, -13996, -14007, -13985, -14077, -14111,
    -14076, -14151, -14206, -14167, -14220, -14293, -14256, -14286, -14370, -14343, -14349, -14438, -14426, -14411,
    -14497, -14504, -14472, -14548, -14576, -14533, -14592, -14639, -14593, -14631, -14694, -14651, -14667, -14739,
    -14707, -14700, -14774, -14759, -14732, -14801, -14804, -14764, -14820, -14843, -14794, -14834, -14873, -14823,
    -14842, -14894, -14850, -14848, -14906, -14873, -14851, -14909, -14892, -14853, -14904, -14904, -14854, -14892,
    -14908, -14854, -14875, -14904, -14851, -14854, -14891, -14845, -14830, -14870, -14835, -14803, -14842, -14819,
    -14774, -14807, -14797, -14743, -14765, -14769, -14710, -14717, -14733, -14675, -14665, -14688, -14637, -14610,
    -14635, -14594, -14553, -14575, -14546, -14493, -14508, -14492, -14431, -14435, -14431, -14367, -14358, -14362,
    -14300, -14276, -14286, -14230, -14191, -14202, -14156, -14103, -14111, -14076, -14014, -14014, -13990, -13922,
    -13911, -13897, -13828, -13804, -13797, -13731, -13693, -13690, -13630, -13579, -13576, -13525, -13463, -13456,
    -13414, -13344, -13330, -13298, -13223, -13199, -13175, -13100, -13063, -13046, -12974, -12924, -12910, -12844,
    -12783, -12767, -12710, -12639, -12619, -12570, -12493, -12466, -12425, -12344, -12308, -12275, -12193, -12146,
    -12118, -12039, -11981, -11955, -11882, -11813, -11786, -11721, -11643, -11612, -11555, -11471, -11433, -11384,
    -11297, -11250, -11208, -11121, -11063, -11026, -10942, -10873, -10838, -10761, -10681, -10645, -10575, -10488,
    -10446, -10385, -10293, -10244, -10190, -10096, -10038, -9990,  -9897,  -9829,  -9785,  -9696,  -9618,  -9575,
    -9492,  -9405,  -9359,  -9285,  -9191,  -9139,  -9073,  -8976,  -8916,  -8857,  -8759,  -8690,  -8636,  -8540,
    -8462,  -8410,  -8319,  -8233,  -8180,  -8095,  -8002,  -7946,  -7868,  -7770,  -7708,  -7637,  -7537,  -7468,
    -7402,  -7303,  -7225,  -7163,  -7067,  -6981,  -6921,  -6829,  -6735,  -6675,  -6588,  -6489,  -6425,  -6345,
    -6242,  -6173,  -6099,  -5994,  -5918,  -5849,  -5746,  -5662,  -5596,  -5496,  -5404,  -5340,  -5245,  -5146,
    -5080,  -4992,  -4888,  -4817,  -4736,  -4630,  -4553,  -4477,  -4372,  -4287,  -4215,  -4113,  -4021,  -3951,
    -3852,  -3755,  -3684,  -3590,  -3489,  -3415,  -3326,  -3222,  -3145,  -3061,  -2955,  -2873,  -2794,  -2688,
    -2601,  -2524,  -2421,  -2328,  -2253,  -2154,  -2055,  -1980,  -1885,  -1783,  -1706,  -1615,  -1511,  -1431,
    -1344,  -1239,  -1156,  -1072,  -967,   -880,   -799,   -696,   -604,   -525,   -425,   -328,   -250,   -154,
    -53,    26,     118,    221,    302,    390,    494,    579,    663,    766,    855,    936,    1038,   1130,
    1210,   1309,   1404,   1484,   1579,   1678,   1758,   1849,   1950,   2032,   2119,   2220,   2306,   2389,
    2489,   2578,   2659,   2757,   2849,   2928,   3024,   3119,   3197,   3290,   3387,   3465,   3555,   3653,
    3733,   3819,   3917,   4000,   4082,   4180,   4265,   4344,   4441,   4529,   4605,   4700,   4791,   4865,
    4957,   5051,   5125,   5212,   5308,   5383,   5466,   5563,   5640,   5718,   5815,   5895,   5970,   6064,
    6148,   6220,   6311,   6398,   6469,   6556,   6645,   6716,   6799,   6889,   6961,   7040,   7130,   7204,
    7279,   7369,   7445,   7516,   7604,   7683,   7751,   7836,   7918,   7985,   8065,   8150,   8216,   8292,
    8378,   8445,   8517,   8602,   8671,   8740,   8823,   8894,   8960,   9040,   9114,   9178,   9254,   9330,
    9393,   9466,   9542,   9605,   9675,   9750,   9814,   9881,   9955,   10020,  10083,  10156,  10223,  10283,
    10353,  10421,  10480,  10547,  10615,  10674,  10738,  10805,  10864,  10925,  10992,  11050,  11109,  11174,
    11233,  11289,  11352,  11412,  11466,  11526,  11587,  11639,  11697,  11757,  11809,  11863,  11923,  11975,
    12026,  12084,  12137,  12186,  12241,  12294,  12341,  12394,  12447,  12493,  12543,  12595,  12641,  12688,
    12738,  12784,  12829,  12878,  12922,  12966,  13013,  13056,  13098,  13144,  13186,  13226,  13270,  13311,
    13350,  13391,  13432,  13469,  13508,  13548,  13584,  13620,  13659,  13695,  13728,  13765,  13800,  13832,
    13867,  13900,  13931,  13964,  13996,  14026,  14056,  14087,  14116,  14143,  14173,  14201,  14226,  14254,
    14281,  14305,  14330,  14356,  14379,  14401,  14426,  14448,  14468,  14491,  14511,  14530,  14551,  14570,
    14587,  14606,  14624,  14640,  14656,  14673,  14687,  14701,  14717,  14729,  14742,  14755,  14767,  14777,
    14789,  14799,  14808,  14817,  14826,  14834,  14841,  14848,  14854,  14860,  14865,  14870,  14873,  14877,
    14881,  14882};
#define IIR_M 5
const static int32_t coef_sos[IIR_M * 5] = {526133493, 848256040, 633507676, 236223201, 96636764,  0,         515396075,
                                            654982512, 762356695, 204010946, 214748364, 762356695, 547608330, 987842478,
                                            493921239, 891205713, 869730877, 998579896, 794568949, 0,         633507676,
                                            858993459, 386547056, 848256040, 1063004405};
const static int16_t coef_g[IIR_M]       = {16384, 8192, 4096, 2048, 1024};
static int32_t objmem[256]               = {};

int TEST_IIR()
{
    int i, ret = 0;
    bqriir32x32_df1_handle_t handle;
    PRINTF("/*IIR TEST START*/\r\n");
    handle = bqriir32x32_df1_init(objmem, IIR_M, coef_sos, coef_g, 0);
    tic    = get_ccount();
    bqriir32x32_df1(handle, NULL, iir_out, iir_x, 1024);
    toc = get_ccount();
    for (i = 0; i < IIR_LENGTH; i++)
    {
        if (iir_out[i] != iir_out_ref[i])
        {
            PRINTF("MISMATCH @ %d sample expected %d result %d\r\n", i, iir_out_ref[i], iir_out[i]);
            ret = -1;
        }
    }
    PRINTF("IIR 32 1024 takes %d cycles\r\n", toc - tic);
    PRINTF("/*IIR TEST END with %d */\r\n\r\n", ret);
    return ret;
}

#define FIR_LENGTH 64
#define FIR_M      64
static int32_t fir_e[FIR_LENGTH]      = {};
const static int32_t fir_h_ref[FIR_M] = {
    0,          52686013,   105245101,  157550644,  209476634,  260897977,  311690793,  361732719,
    410903200,  459083778,  506158384,  552013609,  596538986,  639627248,  681174592,  721080927,
    759250114,  795590202,  830013643,  862437509,  892783688,  920979072,  946955737,  970651103,
    992008086,  1010975234, 1027506854, 1041563121, 1053110171, 1062120186, 1068571460, 1072448453,
    1073741823, 1072448456, 1068571466, 1062120194, 1053110182, 1041563135, 1027506871, 1010975253,
    992008108,  970651128,  946955764,  920979102,  892783720,  862437544,  830013680,  795590241,
    759250155,  721080969,  681174636,  639627294,  596539034,  552013659,  506158434,  459083830,
    410903253,  361732773,  311690848,  260898033,  209476691,  157550701,  105245158,  52686070};
const static int32_t fir_r_ref[FIR_LENGTH] = {
    2784,       52687975,   105245127,  157551129,  209480572,  260899599,  311690864,  361732998,
    410904911,  459085677,  506162152,  552013733,  596539132,  639630371,  681178382,  721082228,
    759252428,  795593181,  830014978,  862438380,  892787610,  920979899,  946958840,  970653120,
    992011496,  1010976065, 1027509675, 1041565392, 1053112620, 1062121586, 1068572784, 1072451133,
    1073743011, 1072450743, 1068572751, 1062121479, 1053112929, 1041563681, 1027509789, 1010979047,
    992010538,  970651799,  946958915,  920979653,  892787363,  862441108,  830016340,  795592792,
    759252140,  721081076,  681177636,  639628174,  596540644,  552013841,  506160429,  459083884,
    410905774,  361733050,  311692285,  260901927,  209478927,  157554346,  105247954,  52687892};
const static int32_t fir_x_ref[FIR_LENGTH + FIR_M] = {
    0,           52686013,    105245101,   157550644,   209476634,   260897977,   311690793,   361732719,   410903200,
    459083778,   506158384,   552013609,   596538986,   639627248,   681174592,   721080927,   759250114,   795590202,
    830013643,   862437509,   892783688,   920979072,   946955737,   970651103,   992008086,   1010975234,  1027506854,
    1041563121,  1053110171,  1062120186,  1068571460,  1072448453,  1073741823,  1072448456,  1068571466,  1062120194,
    1053110182,  1041563135,  1027506871,  1010975253,  992008108,   970651128,   946955764,   920979102,   892783720,
    862437544,   830013680,   795590241,   759250155,   721080969,   681174636,   639627294,   596539034,   552013659,
    506158434,   459083830,   410903253,   361732773,   311690848,   260898033,   209476691,   157550701,   105245158,
    52686070,    57,          -52685955,   -105245043,  -157550587,  -209476578,  -260897921,  -311690738,  -361732665,
    -410903146,  -459083726,  -506158333,  -552013560,  -596538938,  -639627202,  -681174547,  -721080884,  -759250074,
    -795590163,  -830013607,  -862437475,  -892783656,  -920979042,  -946955710,  -970651079,  -992008064,  -1010975214,
    -1027506838, -1041563107, -1053110159, -1062120177, -1068571455, -1072448450, -1073741823, -1072448459, -1068571472,
    -1062120203, -1053110193, -1041563149, -1027506888, -1010975273, -992008130,  -970651152,  -946955791,  -920979131,
    -892783752,  -862437578,  -830013716,  -795590279,  -759250196,  -721081012,  -681174681,  -639627340,  -596539082,
    -552013708,  -506158485,  -459083882,  -410903306,  -361732828,  -311690903,  -260898088,  -209476747,  -157550758,
    -105245215,  -52686128};
const static int32_t fir_e_ref[] = {
    -2147480863, -2094795672, -2042238520, -1989932518, -1938003075, -1886584048, -1835792783, -1785750649,
    -1736578736, -1688397970, -1641321495, -1595469914, -1550944515, -1507853276, -1466305265, -1426401419,
    -1388231219, -1351890466, -1317468669, -1285045267, -1254696037, -1226503748, -1200524807, -1176830527,
    -1155472151, -1136507582, -1119973972, -1105918255, -1094371027, -1085362061, -1078910863, -611471875,
    230765420,   1072449376,  1911547611,  2147483647,  2147483647,  2147483647,  2147483647,  2147483647,
    2147483647,  2147483647,  2147483647,  2147483647,  2147483647,  2147483647,  2147483647,  2147483647,
    2147483647,  2147483647,  2147483647,  2147483647,  2147483647,  2147483647,  2147483647,  2147483647,
    2147483647,  2147483647,  2147483647,  2147483647,  2147483647,  2147483647,  2147483647,  2147483647};

int TEST_FIR_BLMS()
{
    int i, ret = 0;
    int64_t norm64;
    int32_t fir_h[FIR_M]              = {};
    int32_t fir_r[FIR_LENGTH]         = {};
    int32_t fir_x[FIR_LENGTH + FIR_M] = {};
    for (i = 0; i < FIR_M; i++)
        fir_h[i] = fir_h_ref[i];
    for (i = 0; i < FIR_LENGTH; i++)
        fir_r[i] = fir_r_ref[i];
    for (i = 0; i < FIR_LENGTH + FIR_M; i++)
        fir_x[i] = fir_x_ref[i];
    PRINTF("/*FIR BLMS TEST START*/\r\n");
    norm64 = vec_power32x32(fir_x, 31, 64);
    tic    = get_ccount();
    fir_blms32x32(fir_e, fir_h, fir_r, fir_x, norm64, norm64, 64, 64);
    toc = get_ccount();
    for (i = 0; i < FIR_LENGTH; i++)
    {
        if (fir_e[i] != fir_e_ref[i])
        {
            PRINTF("MISMATCH @ %d sample expected %d result %d\r\n", i, fir_e_ref[i], fir_e[i]);
            ret = -1;
        }
    }
    PRINTF("FIR BLMS 64 64 takes %d cycles\r\n", toc - tic);
    PRINTF("/*FIR BLMS TEST END with %d */\r\n\r\n", ret);
    return ret;
}
