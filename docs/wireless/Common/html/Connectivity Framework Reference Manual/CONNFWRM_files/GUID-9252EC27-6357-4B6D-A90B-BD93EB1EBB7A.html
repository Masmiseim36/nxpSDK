<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2005"/>
<meta name="DC.rights.owner" content="(C) Copyright 2005"/>
<meta name="DC.Type" content="topic"/>
<meta name="DC.Title" content="Memory management API primitives"/>
<meta name="DC.Relation" scheme="URI" content="GUID-CCA67CCD-5FF2-401B-9D0C-E1AB611EA04C.html"/>
<meta name="prodname" content=""/>
<meta name="version" content="1"/>
<meta name="release" content="0"/>
<meta name="modification" content="0"/>
<meta name="DC.Creator" content="NXP Semiconductors"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-9252EC27-6357-4B6D-A90B-BD93EB1EBB7A"/>
<meta name="DC.Language" content="en-us"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Memory management API primitives</title>
</head>
<body id="GUID-9252EC27-6357-4B6D-A90B-BD93EB1EBB7A">


    <h1 class="title topictitle1">Memory management API primitives</h1>

    <div class="body">
        <p class="p"><strong class="ph b"><span class="ph" id="GUID-9252EC27-6357-4B6D-A90B-BD93EB1EBB7A___TOC346017070">MEM_Init()</span></strong></p>

        <p class="p"><strong class="ph b">Prototype:</strong></p>

        <pre class="pre codeblock">memStatus_t MEM_Init
<strong class="ph b">(</strong>
void
<strong class="ph b">);</strong></pre>

        <p class="p"><strong class="ph b">Description:</strong></p>

        <p class="p">This function is used to initialize the memory management subsystem. The function
            allocates memory for all partitions and initializes the partitions and partition blocks.
            The function must be called before any other memory management API function.</p>

        <p class="p"><strong class="ph b">Parameters:</strong></p>

        <p class="p">None.</p>

        <p class="p"><strong class="ph b">Returns:</strong></p>

        <p class="p">The function returns MEM_SUCCESS_c if initialization succeeds or MEM_INIT_ERROR_c
            otherwise.</p>

        <p class="p"><strong class="ph b"><span class="ph" id="GUID-9252EC27-6357-4B6D-A90B-BD93EB1EBB7A___TOC346017071">MEM_BufferAllocWithId ()</span></strong></p>

        <p class="p"><strong class="ph b">Prototype:</strong></p>

        <pre class="pre codeblock">void* MEM_BufferAllocWithId
(
    uint32_t numBytes,
    uint8_t poolId,
    void *pCaller
);</pre>

        <p class="p"><strong class="ph b">Description:</strong></p>

        <p class="p">This function allocates a buffer from an existing partition with free blocks. The size of
            the allocated buffer is equal to or greater than the requested size.</p>

        <p class="p"><strong class="ph b">Parameters:</strong></p>

        
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="GUID-9252EC27-6357-4B6D-A90B-BD93EB1EBB7A__TABLE_RSQ_DLK_2Z" class="table" frame="border" border="1" rules="all">
                
                
                
                
                <thead class="thead" align="left">
                    <tr class="row">
                        <th class="entry" valign="top" id="d47180e116"><strong class="ph b">Name</strong></th>

                        <th class="entry" valign="top" id="d47180e120"><strong class="ph b">Type</strong></th>

                        <th class="entry" valign="top" id="d47180e124"><strong class="ph b">Direction</strong></th>

                        <th class="entry" valign="top" id="d47180e128"><strong class="ph b">Description</strong></th>

                    </tr>

                </thead>

                <tbody class="tbody">
                    <tr class="row">
                        <td class="entry" valign="top" headers="d47180e116 ">numBytes</td>

                        <td class="entry" valign="top" headers="d47180e120 ">uint32_t</td>

                        <td class="entry" valign="top" headers="d47180e124 ">[IN]</td>

                        <td class="entry" valign="top" headers="d47180e128 ">Requested buffer size, in bytes</td>

                    </tr>

                    <tr class="row">
                        <td class="entry" valign="top" headers="d47180e116 ">poolId</td>

                        <td class="entry" valign="top" headers="d47180e120 ">uint8_t</td>

                        <td class="entry" valign="top" headers="d47180e124 ">[IN]</td>

                        <td class="entry" valign="top" headers="d47180e128 ">The Id of the pools where to search for a free memory buffer</td>

                    </tr>

                    <tr class="row">
                        <td class="entry" valign="top" headers="d47180e116 ">pCaller</td>

                        <td class="entry" valign="top" headers="d47180e120 ">void*</td>

                        <td class="entry" valign="top" headers="d47180e124 ">[IN]</td>

                        <td class="entry" valign="top" headers="d47180e128 ">The address from where the function who called
                            MEM_BufferAllocWithId() was called (for debug purpose)</td>

                    </tr>

                </tbody>

            </table>
</div>

        <p class="p"><strong class="ph b">Returns:</strong></p>

        <p class="p">A pointer to the allocated buffer (partition block) or NULL if the allocation operation
            fails.</p>

        <p class="p"><strong class="ph b"><span class="ph" id="GUID-9252EC27-6357-4B6D-A90B-BD93EB1EBB7A___TOC346017072">MEM_BufferFree()</span></strong></p>

        <p class="p"><strong class="ph b">Prototype:</strong></p>

        <pre class="pre codeblock">memStatus_t MEM_BufferFree
(
    void* buffer
);</pre>

        <p class="p"><strong class="ph b">Description:</strong></p>

        <p class="p">The function attempts to free the buffer passed as a function argument.</p>

        <p class="p"><strong class="ph b">Parameters:</strong></p>

        
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="GUID-9252EC27-6357-4B6D-A90B-BD93EB1EBB7A__TABLE_XVG_KLK_2Z" class="table" frame="border" border="1" rules="all">
                
                
                
                
                <thead class="thead" align="left">
                    <tr class="row">
                        <th class="entry" valign="top" id="d47180e233"><strong class="ph b">Name</strong></th>

                        <th class="entry" valign="top" id="d47180e237"><strong class="ph b">Type</strong></th>

                        <th class="entry" valign="top" id="d47180e241"><strong class="ph b">Direction</strong></th>

                        <th class="entry" valign="top" id="d47180e245"><strong class="ph b">Description</strong></th>

                    </tr>

                </thead>

                <tbody class="tbody">
                    <tr class="row">
                        <td class="entry" valign="top" headers="d47180e233 ">buffer</td>

                        <td class="entry" valign="top" headers="d47180e237 ">void * </td>

                        <td class="entry" valign="top" headers="d47180e241 ">[IN]</td>

                        <td class="entry" valign="top" headers="d47180e245 ">The buffer to be freed</td>

                    </tr>

                </tbody>

            </table>
</div>

        <p class="p"><strong class="ph b">Returns:</strong></p>

        <p class="p">If the buffer is successfully freed, the function returns MEM_SUCCESS_c. Otherwise, it
            returns MEM_FREE_ERROR_c.</p>

        <div class="note note"><span class="notetitle">Note:</span> Call MEM_BufferFree() only on a pointer that was returned by MEM_BufferAlloc(). Do not
            call the free function for a buffer that is already free.</div>

        <p class="p"><span class="ph"><strong class="ph b">MEM_BufferRealloc()</strong></span></p>

        <div class="p"><strong class="ph b">Prototype</strong><pre class="pre codeblock">
            void* MEM_BufferRealloc(void* buffer, uint32_t new_size);
        </pre>
</div>

        <p class="p"><strong class="ph b">Description</strong></p>

        <p class="p">This function can be used to request a larger buffer.</p>

        <div class="p">MEM_BufferRealloc is based on standard C realloc() behavior:
        <ul class="ul">
            <li class="li">If new requested size is 0, acts like MEM_BufferFree and returns NULL.</li>

               <li class="li">If input pointer is NULL, acts like MEM_BufferAllocate and returns pointer to
                    allocated buffer.</li>

             <li class="li">If the new requested size is smaller/equal to block size, returns input pointer. -
                    If new requested size is bigger than block size, allocates a new buffer, copy
                    the input buffer data to new buffer, frees the input buffer and returns pointer
                    to new allocated buffer.</li>

             <li class="li">If MEM_BufferAllocate fails, MEM_BufferRealloc returns a NULL pointer and doesn't
                    free the input buffer </li>

        </ul>
</div>

        <p class="p"><strong class="ph b">Parameters:</strong></p>

        
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="GUID-9252EC27-6357-4B6D-A90B-BD93EB1EBB7A__TABLE_XG4_RGJ_TKB" class="table" frame="border" border="1" rules="all">
                
                
                
                
                <thead class="thead" align="left">
                    <tr class="row">
                        <th class="entry" valign="top" id="d47180e338"><strong class="ph b">Name</strong></th>

                        <th class="entry" valign="top" id="d47180e342"><strong class="ph b">Type</strong></th>

                        <th class="entry" valign="top" id="d47180e346"><strong class="ph b">Direction</strong></th>

                        <th class="entry" valign="top" id="d47180e350"><strong class="ph b">Description</strong></th>

                    </tr>

                </thead>

                <tbody class="tbody">
                    <tr class="row">
                        <td class="entry" valign="top" headers="d47180e338 ">buffer</td>

                        <td class="entry" valign="top" headers="d47180e342 ">void*</td>

                        <td class="entry" valign="top" headers="d47180e346 ">IN</td>

                        <td class="entry" valign="top" headers="d47180e350 ">Pointer to original buffer to be reallocated </td>

                    </tr>

                    <tr class="row">
                        <td class="entry" valign="top" headers="d47180e338 ">new_size</td>

                        <td class="entry" valign="top" headers="d47180e342 ">uint32_t</td>

                        <td class="entry" valign="top" headers="d47180e346 ">IN</td>

                        <td class="entry" valign="top" headers="d47180e350 ">New size requested</td>

                    </tr>

                </tbody>

            </table>
</div>
<p class="p"><strong class="ph b">Returns</strong></p>
<p class="p">Pointer to the newly allocated buffer or NULL if the allocation fails.</p>

        <p class="p"><strong class="ph b"><span class="ph" id="GUID-9252EC27-6357-4B6D-A90B-BD93EB1EBB7A___TOC346017073">MEM_GetAvailableBlocks()</span></strong></p>

        <p class="p"><strong class="ph b">Prototype:</strong></p>

        <pre class="pre codeblock">uint32_t MEM_GetAvailableBlocks
(
    uint32_t size
);</pre>

        <p class="p"> </p>

        <p class="p"><strong class="ph b">Description:</strong></p>

        <p class="p">This function checks how many buffers are available with a size equal or greater than the
            specified size.</p>

        <p class="p"><strong class="ph b">Parameters:</strong></p>

        
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="GUID-9252EC27-6357-4B6D-A90B-BD93EB1EBB7A__TABLE_GXY_SLK_2Z" class="table" frame="border" border="1" rules="all">
                
                
                
                
                <thead class="thead" align="left">
                    <tr class="row">
                        <th class="entry" valign="top" id="d47180e441"><strong class="ph b">Name</strong></th>

                        <th class="entry" valign="top" id="d47180e445"><strong class="ph b">Type</strong></th>

                        <th class="entry" valign="top" id="d47180e449"><strong class="ph b">Direction</strong></th>

                        <th class="entry" valign="top" id="d47180e453"><strong class="ph b">Description</strong></th>

                    </tr>

                </thead>

                <tbody class="tbody">
                    <tr class="row">
                        <td class="entry" valign="top" headers="d47180e441 ">size</td>

                        <td class="entry" valign="top" headers="d47180e445 ">uint32_t</td>

                        <td class="entry" valign="top" headers="d47180e449 ">[IN]</td>

                        <td class="entry" valign="top" headers="d47180e453 ">The size on whose basis the buffers are queried</td>

                    </tr>

                </tbody>

            </table>
</div>

        <p class="p"><strong class="ph b">Returns:</strong></p>

        <p class="p">The buffer count that satisfied the condition to have their size equal to or greater than
            the size specified by the function argument.</p>

        <p class="p"><strong class="ph b">MEM_BufferGetSize()</strong></p>

        <p class="p"><strong class="ph b">Prototype:</strong></p>

        <pre class="pre codeblock">uint16_t MEM_BufferGetSize
(
    void* buffer
);</pre>

        <p class="p"><strong class="ph b">Description:</strong></p>

        <p class="p">This function queries the size of the given buffer.</p>

        <p class="p"><strong class="ph b">Parameters:</strong></p>

        
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="GUID-9252EC27-6357-4B6D-A90B-BD93EB1EBB7A__TABLE_NRG_YLK_2Z" class="table" frame="border" border="1" rules="all">
                
                
                
                
                <thead class="thead" align="left">
                    <tr class="row">
                        <th class="entry" valign="top" id="d47180e527"><strong class="ph b">Name</strong></th>

                        <th class="entry" valign="top" id="d47180e531"><strong class="ph b">Type</strong></th>

                        <th class="entry" valign="top" id="d47180e535"><strong class="ph b">Direction</strong></th>

                        <th class="entry" valign="top" id="d47180e539"><strong class="ph b">Description</strong></th>

                    </tr>

                </thead>

                <tbody class="tbody">
                    <tr class="row">
                        <td class="entry" valign="top" headers="d47180e527 ">buffer</td>

                        <td class="entry" valign="top" headers="d47180e531 ">void *</td>

                        <td class="entry" valign="top" headers="d47180e535 ">[IN]</td>

                        <td class="entry" valign="top" headers="d47180e539 ">Pointer to the allocated buffer.</td>

                    </tr>

                </tbody>

            </table>
</div>

        <p class="p"><strong class="ph b">Returns:</strong></p>

        <p class="p">The buffer size.</p>

        <p class="p"><strong class="ph b">MEM_BufferCheck ()</strong></p>

        <p class="p"><strong class="ph b">Prototype:</strong></p>

        <pre class="pre codeblock">uint8_t MEM_BufferCheck
(
    uint8_t *p, 
    uint32_t size
);</pre>

        <p class="p"><strong class="ph b">Description:</strong></p>

        <p class="p">The function is used internally by the FLib_MemCpy() and FLib_MemSet() functions to check
            for memory buffer overflow for debugging.</p>

        <p class="p"><strong class="ph b">Parameters:</strong></p>

        
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="GUID-9252EC27-6357-4B6D-A90B-BD93EB1EBB7A__TABLE_KLC_DMK_2Z" class="table" frame="border" border="1" rules="all">
                
                
                
                
                <thead class="thead" align="left">
                    <tr class="row">
                        <th class="entry" valign="top" id="d47180e612"><strong class="ph b">Name</strong></th>

                        <th class="entry" valign="top" id="d47180e616"><strong class="ph b">Type</strong></th>

                        <th class="entry" valign="top" id="d47180e620"><strong class="ph b">Direction</strong></th>

                        <th class="entry" valign="top" id="d47180e624"><strong class="ph b">Description</strong></th>

                    </tr>

                </thead>

                <tbody class="tbody">
                    <tr class="row">
                        <td class="entry" valign="top" headers="d47180e612 ">p</td>

                        <td class="entry" valign="top" headers="d47180e616 ">uint8_t*</td>

                        <td class="entry" valign="top" headers="d47180e620 ">[IN]</td>

                        <td class="entry" valign="top" headers="d47180e624 ">Pointer to the location where data will be placed</td>

                    </tr>

                    <tr class="row">
                        <td class="entry" valign="top" headers="d47180e612 ">size</td>

                        <td class="entry" valign="top" headers="d47180e616 ">uint32_t</td>

                        <td class="entry" valign="top" headers="d47180e620 ">[IN]</td>

                        <td class="entry" valign="top" headers="d47180e624 ">Number of bytes to write</td>

                    </tr>

                </tbody>

            </table>
</div>

        <p class="p"><strong class="ph b">Returns:</strong></p>

        <p class="p">1 – Memory overflow detected</p>

        <p class="p">0 – No memory overflow</p>

        <p class="p"><strong class="ph b">MEM_CheckIfMemBuffersAreFreed ()</strong></p>

        <p class="p"><strong class="ph b">Prototype:</strong></p>

        <pre class="pre codeblock">void MEM_CheckIfMemBuffersAreFreed
(
    void
);</pre>

        <p class="p"><strong class="ph b">Description:</strong></p>

        <p class="p">The function checks memory buffers that are allocated for more than the maximum duration
            specified for debugging.</p>

        <p class="p">This function may be called from the Idle Task.</p>

        <p class="p"><strong class="ph b">Parameters:</strong></p>

        <p class="p">None.</p>

        <p class="p"><strong class="ph b">Returns:</strong></p>

        <p class="p">None.</p>

        <p class="p"><strong class="ph b">MEM_WriteReadTest()</strong></p>

        <p class="p"><strong class="ph b">Prototype:</strong></p>

        <pre class="pre codeblock">uint32_t MEM_WriteReadTest
(
    void
);</pre>

        <p class="p"><strong class="ph b">Description:</strong></p>

        <p class="p">The function performs a write-read-verify test across all pools. </p>

        <p class="p">This function is intended for module testing only.</p>

        <p class="p"><strong class="ph b">Parameters:</strong></p>

        <p class="p">None.</p>

        <p class="p"><strong class="ph b">Returns:</strong></p>

        <p class="p">Returns MEM_SUCCESS_c if test was successful, MEM_ALLOC_ERROR_c if a buffer
            was not allocated successfully, MEM_FREE_ERROR_c if a buffer was not freed successfully,
            or MEM_UNKNOWN_ERROR_c if a verify error, heap overflow or a data corruption
            occurred.</p>

        <p class="p"/>

        <p class="p"><strong class="ph b">MEM_GetTimeStamp()</strong></p>

        <p class="p"><strong class="ph b">Prototype:</strong></p>

        <pre class="pre codeblock">extern uint32_t MEM_GetTimeStamp
(
    void
);</pre>

        <p class="p"><strong class="ph b">Description:</strong></p>

        <p class="p">The function is used for debug purpose and should be implemented by the
            application. </p>

        <p class="p"><strong class="ph b">Parameters:</strong></p>

        <p class="p">None.</p>

        <p class="p"><strong class="ph b">Returns:</strong></p>

        <p class="p">This function returns a time-stamp value in milliseconds.</p>

    </div>

<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="GUID-CCA67CCD-5FF2-401B-9D0C-E1AB611EA04C.html">Memory Management</a></div>
</div>
</div>

</body>
</html>