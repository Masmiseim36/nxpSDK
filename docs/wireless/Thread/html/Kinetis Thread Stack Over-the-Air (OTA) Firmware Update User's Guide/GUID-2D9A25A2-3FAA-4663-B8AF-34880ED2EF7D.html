<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2005"/>
<meta name="DC.rights.owner" content="(C) Copyright 2005"/>
<meta name="DC.Type" content="topic"/>
<meta name="DC.Title" content="Software implementation"/>
<meta name="prodname" content="MC56F825x"/>
<meta name="version" content="4"/>
<meta name="release" content="0"/>
<meta name="modification" content="0"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="GUID-2D9A25A2-3FAA-4663-B8AF-34880ED2EF7D"/>
<meta name="DC.Language" content="en-us"/>
<link rel="stylesheet" type="text/css" href="commonltr.css"/>
<title>Software implementation</title>
</head>
<body id="GUID-2D9A25A2-3FAA-4663-B8AF-34880ED2EF7D">


    <h1 class="title topictitle1">Software implementation</h1>

    <div class="body">
        <p class="p"/>

        <p class="p">The files app_ota.h, app_ota_client.c, app_ota_server.c, OtaSupport.c, OtaSupport.h
            comprise the OTA Upgrade functionality. All configurations are done at compile time. The
            configuration settings needed to enable the OTAServer and OTAClient functionalities are
            available in the config.h file of the corresponding example project and have already
            been set to the appropriate values.</p>

        <p class="p"> </p>

        <ul class="ul" id="GUID-2D9A25A2-3FAA-4663-B8AF-34880ED2EF7D__UL_FTK_VMK_3Z">
            <li class="li">gEnableOTAServer_d = TRUE – enables the OTA Server functionality;</li>

            <li class="li">gEnableOTAClient_d = TRUE – enables the OTA Client functionality; </li>

            <li class="li"> gEepromType_d = <span class="ph">gEepromDevice_
                    AT45DB041E_c</span>
                – use this particular EEPROM device type to store the image in the external flash of
                the client for <span class="ph">FRDM-KW41</span> boards. For other boards, check
                Eeprom.h;</li>

            <li class="li">OTA_USE_NWK_DATA = TRUE – includes the OTA server data in a Service TLV in Network
                Data packets, so each board will always be aware of the server’s short address.
            </li>

        </ul>

        <p class="p">OTA client/server initialization is performed by the following API: </p>

        <ul class="ul" id="GUID-2D9A25A2-3FAA-4663-B8AF-34880ED2EF7D__UL_L5K_VMK_3Z">
            <li class="li">OtaClientInit(mpAppThreadMsgQueue);</li>

            <li class="li">OtaServerInit(mpAppThreadMsgQueue);</li>

        </ul>

        <p class="p"> </p>

        <p class="p">OTA client project options; </p>

        <ul class="ul" id="GUID-2D9A25A2-3FAA-4663-B8AF-34880ED2EF7D__UL_AVK_VMK_3Z">
            <li class="li">gUseBootloaderLink_d=1 – sets the linker configuration file to reserve the first
                flash sector for bootloader use with the application firmware following in the
                subsequent sectors.</li>

            <li class="li">gUseInternalStorageLink_d=0 – use external flash for temporary storing the image
                sent over the air; otherwise uses the internal flash.</li>

            <li class="li">gEraseNVMLink_d=1 – includes NVM firmware sectors in OTA file, and will
                overwrite those sectors when performing OTA update. When using .bin format,
                gEraseNVMLink_d must be set to 0 to preserve NVM data.</li>

            <li class="li">gNVMSectorCountLink_d=32 – allocates 32 sectors of NVM, each having 2 kB of
                memory.</li>

            <li class="li">gUseNVMLink_d=1 – sets the linker configuration to access the NVM. </li>

            <li class="li">__ram_vector_table__=1 – places the vector table in RAM and allows dynamic insertion
                of an ISR handler. </li>

        </ul>

        <p class="p"> </p>

        <p class="p"> </p>

        <p class="p">The following figures describe how to update the symbols definition of the Linker
            configuration files for IAR IDE.</p>

      <div class="fig fignone"><span class="figcap">Figure 1. IAR Linker Configuration Options</span><br/><img class="image" src="GUID-B0B017EE-AD0E-4942-BB30-1504A8404FB6-high.png"/><br/></div>

        
        
        <p class="p">In the case of MCU Xpresso IDE, the linker file for the ota client project is preconfigured with the appropriate settings.</p>

    </div>
 

</body>
</html>