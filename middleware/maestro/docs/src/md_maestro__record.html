<!-- HTML header for doxygen 1.10.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Maestro Audio Framework: Maestro record example</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="new_stylesheet.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="fs_logo.svg"/></td>
  <td id="projectalign">
   <div id="projectname">Maestro Audio Framework<span id="projectnumber">&#160;v 1.7</span>
   </div>
   <div id="projectbrief">NXP Semiconductors</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md_maestro__record.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Maestro record example</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md54"></a> </p>
<h1><a class="anchor" id="autotoc_md55"></a>
Table of content</h1>
<ul>
<li><a class="el" href="#maestro-record-overview">Overview</a></li>
<li><a class="el" href="#maestro-record-HW-requirements">Hardware requirements</a></li>
<li><a class="el" href="#maestro-record-HW-modifications">Hardware modifications</a></li>
<li><a class="el" href="#maestro-record-preparation">Preparation</a></li>
<li><a class="el" href="#maestro-record-running-the-demo">Running the demo</a></li>
<li><a class="el" href="#maestro-record-example-configuration">Example configuration</a></li>
<li><a class="el" href="#maestro-record-functionality">Functionality</a></li>
<li><a class="el" href="#maestro-record-states">States</a></li>
<li><a class="el" href="#maestro-record-commands-in-detail">Commands in detail</a></li>
<li><a class="el" href="#maestro-record-processing-time">Processing Time</a></li>
</ul>
<h1><a class="anchor" id="maestro-record-overview"></a>
Overview</h1>
<p>The Maestro record example demonstrates audio processing on the ARM cortex core utilizing the Maestro Audio Framework library.</p>
<p>The application is controlled by commands from a shell interface using serial console.</p>
<p>Depending on target platform or development board there are different modes and features of the demo supported.</p>
<ul>
<li><b>Loopback</b> - The application demonstrates a loopback from the microphone to the speaker without any audio processing.</li>
<li><b>File recording</b> - The application takes audio samples from the microphone inputs and stores them to an SD card as an PCM file. The PCM file has following parameters:<ul>
<li>Mono and stereo : 2 channels, 16kHz, 16bit width</li>
<li>Multi-channel (AUD-EXP-42448): 8 channels, 16kHz, 32bit width</li>
</ul>
</li>
<li><b>Voice control</b> - The application takes audio samples from the microphone input and uses the VIT library to recognize wake words and voice commands. If a wake word or a voice command is recognized, the application write it to the serial terminal.</li>
<li><b>Encoding</b> - The application takes PCM samples from memory and sends them to the Opus encoder. The encoded data is stored in memory and compared to a reference. The result of the comparison is finally written into the serial terminal.</li>
</ul>
<p>As shown in the table below, the application is supported on several development boards, and each development board may have certain limitations, some development boards may also require hardware modifications or allow to use of an audio expansion board. Therefore, please check the supported features and <a class="el" href="#maestro-record-HW-modifications">Hardware modifications</a> or <a class="el" href="#maestro-record-example-configuration">Example configuration</a> sections before running the demo.</p>
<table class="audio_FW_spec_table">
<tr>
<th colspan="1">Mode </th><th colspan="3">Loopback </th><th colspan="3">File recording </th><th colspan="5">Voice control </th><th colspan="1">Encoding    </th></tr>
<tr>
<td colspan="1" rowspan="2">Feature </td><td colspan="3">Audio input / output [num of channels] </td><td colspan="3">Audio inputs [num of channels] </td><td colspan="3">Audio inputs [num of channels] </td><td colspan="2">Additional libraries </td><td colspan="1">Encoder  </td></tr>
<tr>
<td colspan="1">On board codec </td><td colspan="1">DMICs </td><td colspan="1">aud-exp-42448 </td><td colspan="1">On board codec </td><td colspan="1">DMICs </td><td colspan="1">aud-exp-42448 </td><td colspan="1">On board codec </td><td colspan="1">DMICs </td><td colspan="1">aud-exp-42448 </td><td colspan="1">VIT </td><td colspan="1">VoiceSeeker </td><td colspan="1">OPUS  </td></tr>
<tr>
<td colspan="1">EVKC-MIMXRT1060 </td><td colspan="1" class="audio_FW_spec_table_supported">1 / 1 </td><td colspan="1">X </td><td colspan="1" class="audio_FW_spec_table_modification">1-6 / 1-6 </td><td colspan="1" class="audio_FW_spec_table_supported">1 </td><td colspan="1">X </td><td colspan="1" class="audio_FW_spec_table_modification">1-6 </td><td colspan="1" class="audio_FW_spec_table_supported">1 </td><td colspan="1">X </td><td colspan="1" class="audio_FW_spec_table_modification">1-2 </td><td colspan="1" class="audio_FW_spec_table_limited">OK </td><td colspan="1" class="audio_FW_spec_table_limited">OK </td><td colspan="1" class="audio_FW_spec_table_supported">OK  </td></tr>
<tr>
<td colspan="1">EVKB-MIMXRT1170 </td><td colspan="1" class="audio_FW_spec_table_supported">0 / 1-2 </td><td colspan="1" class="audio_FW_spec_table_supported">1-2 </td><td colspan="1">X </td><td colspan="1">X </td><td colspan="1" class="audio_FW_spec_table_supported">1-2 </td><td colspan="1">X </td><td colspan="1">X </td><td colspan="1" class="audio_FW_spec_table_supported">1-2 </td><td colspan="1">X </td><td colspan="1" class="audio_FW_spec_table_limited">OK </td><td colspan="1" class="audio_FW_spec_table_limited">OK </td><td colspan="1" class="audio_FW_spec_table_supported">OK  </td></tr>
<tr>
<td colspan="1">LPCXpresso55s69 </td><td colspan="1" class="audio_FW_spec_table_supported">1-2 / 1-2 </td><td colspan="1">X </td><td colspan="1">X </td><td colspan="1" class="audio_FW_spec_table_supported">1-2 / 1-2 </td><td colspan="1">X </td><td colspan="1">X </td><td colspan="1" class="audio_FW_spec_table_supported">1 </td><td colspan="1">X </td><td colspan="1">X </td><td colspan="1" class="audio_FW_spec_table_modification">OK </td><td colspan="1">X </td><td colspan="1">X  </td></tr>
<tr>
<td colspan="1">EVK-MCXN5XX </td><td colspan="1" class="audio_FW_spec_table_supported">1-2 / 1-2 </td><td colspan="1">X </td><td colspan="1">X </td><td colspan="1" class="audio_FW_spec_table_supported">1-2 </td><td colspan="1">X </td><td colspan="1">X </td><td colspan="1" class="audio_FW_spec_table_supported">1-2 </td><td colspan="1">X </td><td colspan="1">X </td><td colspan="1" class="audio_FW_spec_table_limited">OK </td><td colspan="1">X </td><td colspan="1" class="audio_FW_spec_table_supported">OK  </td></tr>
<tr>
<td colspan="1">RW612BGA </td><td colspan="1" class="audio_FW_spec_table_supported">0 / 1-2 </td><td colspan="1" class="audio_FW_spec_table_supported">1-2 </td><td colspan="1">X </td><td colspan="1">X </td><td colspan="1">X </td><td colspan="1">X </td><td colspan="1">X </td><td colspan="1" class="audio_FW_spec_table_supported">1-2 </td><td colspan="1">X </td><td colspan="1" class="audio_FW_spec_table_limited">OK </td><td colspan="1" class="audio_FW_spec_table_limited">OK </td><td colspan="1">X  </td></tr>
<tr>
<td colspan="1">RW612QFN </td><td colspan="1" class="audio_FW_spec_table_supported">0 / 1-2 </td><td colspan="1" class="audio_FW_spec_table_supported">1-2 </td><td colspan="1">X </td><td colspan="1">X </td><td colspan="1">X </td><td colspan="1">X </td><td colspan="1">X </td><td colspan="1" class="audio_FW_spec_table_supported">1-2 </td><td colspan="1">X </td><td colspan="1" class="audio_FW_spec_table_limited">OK </td><td colspan="1" class="audio_FW_spec_table_limited">OK </td><td colspan="1">X   </td></tr>
</table>
<ul>
<li><div style="font-size:.8em"> <span class="audio_FW_spec_table_supported">Dark green</span> - Fully supported and enabled by default.</div></li>
<li><div style="font-size:.8em"> <span class="audio_FW_spec_table_limited">Orange</span> - Supported with some limitations and enabled by default. See the limitations section below.</div></li>
<li><div style="font-size:.8em"> <span class="audio_FW_spec_table_modification">Light green</span> - Supported, but only available after some SW or HW modification. More information about modification can be found in the <a class="el" href="#maestro-record-example-configuration">Example configuration</a> section.</div></li>
<li><div style="font-size:.8em"> <span>X</span> - Not supported.</div></li>
</ul>
<p><b>Limitations:</b></p><ul>
<li>Addition labraries<ul>
<li><b>VIT:</b><ul>
<li>The VIT is supported only in the MCUXpresso IDE.</li>
<li><em>LPCXpresso55s69</em> - The VIT is disabled by default due to insufficient memory. To enable it, see the <a class="el" href="#maestro-record-example-configuration">Example configuration</a> section.</li>
</ul>
</li>
<li><b>VoiceSeeker:</b><ul>
<li>The VoiceSeeker is supported only in the MCUXpresso IDE.</li>
</ul>
</li>
</ul>
</li>
<li>Encoder<ul>
<li><b>OPUS:</b><ul>
<li><em>LPCXpresso55s69</em> - The encoder is not supported due to insufficient memory.</li>
</ul>
</li>
</ul>
</li>
<li>The File recording mode is not supported on <em>RW612BGA</em> and <em>RW612QFN</em> development boards due to missing SD card slot.</li>
</ul>
<p><b>Known issues:</b></p><ul>
<li><em>EVKB-MIMXRT1170</em> - After several tens of runs (the number of runs is not deterministic), the development board restarts because a power-up sequence is detected on the RESET pin (due to a voltage drop).</li>
</ul>
<p>More information about supported features can be found on the <a class="el" href="md_supported__features.html">Supported features</a> page.</p>
<h1><a class="anchor" id="maestro-record-HW-requirements"></a>
Hardware requirements</h1>
<ul>
<li>Desired development board</li>
<li>Micro USB cable</li>
<li>Headphones with 3.5 mm stereo jack</li>
<li>Personal computer</li>
<li>Optional:<ul>
<li>SD card for file output</li>
<li>Audio expansion board <a href="https://www.nxp.com/part/AUD-EXP-42448#/">AUD-EXP-42448 (REV B)</a></li>
</ul>
</li>
<li><em>LPCXpresso55s69:</em><ul>
<li>Source of sound with 3.5 mm stereo jack connector</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="maestro-record-HW-modifications"></a>
Hardware modifications</h1>
<p>Some development boards need some hardware modifications to run the application. If the development board is not listed here, its default setting is required.</p><ul>
<li><em>EVKB-MIMXRT1170:</em><ol type="1">
<li>Please remove below resistors if on board wifi chip is not DNP:<ul>
<li>R228, R229, R232, R234</li>
</ul>
</li>
<li>Please make sure R136 is weld for GPIO card detect.</li>
</ol>
</li>
<li><em>EVK-MCXN5XX:</em><ul>
<li>Short: JP7 2-3, JP8 2-3, JP10 2-3, JP11 2-3</li>
</ul>
</li>
<li><em>RW612BGA and RW612QFN:</em><ul>
<li>Connect: JP50; Disconnect JP9, JP11</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="maestro-record-preparation"></a>
Preparation</h1>
<ol type="1">
<li>Connect a micro USB cable between the PC host and the debug USB port on the development board</li>
<li>Open a serial terminal with the following settings:<ul>
<li>115200 baud rate</li>
<li>8 data bits</li>
<li>No parity</li>
<li>One stop bit</li>
<li>No flow control</li>
</ul>
</li>
<li>Download the program to the target board.</li>
<li>Insert the headphones into the Line-Out connector (headphone jack) on the development board.</li>
<li><em>LPCXpresso55s69:</em><ul>
<li>Insert source of sound to audio Line-In connector (headphone jack) on the development board.</li>
</ul>
</li>
<li>Either press the reset button on your development board or launch the debugger in your IDE to begin running the demo.</li>
</ol>
<h1><a class="anchor" id="maestro-record-running-the-demo"></a>
Running the demo</h1>
<p>When the example runs successfully, you should see similar output on the serial terminal as below: </p><div class="fragment"><div class="line">*******************************</div>
<div class="line">Maestro audio record demo start</div>
<div class="line">*******************************</div>
<div class="line"> </div>
<div class="line">Copyright  2022  NXP</div>
<div class="line">[APP_SDCARD_Task] start</div>
<div class="line">[APP_Shell_Task] start</div>
<div class="line"> </div>
<div class="line">&gt;&gt; [APP_SDCARD_Task] SD card drive mounted</div>
</div><!-- fragment --><p>Type <code>help</code> to see the command list. Similar description will be displayed on serial console:</p>
<div class="fragment"><div class="line">&gt;&gt; help</div>
<div class="line"> </div>
<div class="line">&quot;help&quot;: List all the registered commands</div>
<div class="line"> </div>
<div class="line">&quot;exit&quot;: Exit program</div>
<div class="line"> </div>
<div class="line">&quot;version&quot;: Display component versions</div>
<div class="line"> </div>
<div class="line">&quot;record_mic&quot;: Record MIC audio and perform one (or more) of following actions:</div>
<div class="line">- playback on codec</div>
<div class="line">- perform VoiceSeeker processing</div>
<div class="line">- perform voice recognition (VIT)</div>
<div class="line">- store samples to a file.</div>
<div class="line"> </div>
<div class="line">USAGE: record_mic [audio|file|&lt;file_name&gt;|vit] 20 [&lt;language&gt;]</div>
<div class="line">The number defines length of recording in seconds.</div>
<div class="line"> </div>
<div class="line">Please see the project defined symbols for the languages supported.</div>
<div class="line">Then specify one of: en/cn/de/es/fr/it/ja/ko/tr as the language parameter.</div>
<div class="line">For voice recognition say supported WakeWord and in 3s frame supported command.</div>
<div class="line">Please note that this VIT demo is near-field and uses 1 on-board microphone.</div>
<div class="line"> </div>
<div class="line">NOTES: This command returns to shell after the recording is finished.</div>
<div class="line">       To store samples to a file, the &quot;file&quot; option can be used to create a file</div>
<div class="line">       with a predefined name, or any file name (without whitespaces) can be specified</div>
<div class="line">       instead of the &quot;file&quot; option.</div>
<div class="line"> </div>
<div class="line">&quot;opus_encode&quot;: Initializes the streamer with the Opus memory-to-memory pipeline and</div>
<div class="line">encodes a hardcoded buffer.</div>
</div><!-- fragment --><p> Details of commands can be found <a class="el" href="#maestro-record-commands-in-detail">here</a>.</p>
<h1><a class="anchor" id="maestro-record-example-configuration"></a>
Example configuration</h1>
<p>The example can be configured by user. Before configuration, please check the <a class="el" href="#maestro-record-overview">table</a> to see if the feature is supported on the development board.</p><ul>
<li><b>Connect AUD-EXP-42448:</b><ul>
<li><em>EVKC-MIMXRT1060:</em><ol type="1">
<li>Disconnect the power supply for safety reasons.</li>
<li>Insert AUD-EXP-42448 into J19 to be able to use the CS42448 codec for multichannel output.</li>
<li>Uninstall J99.</li>
<li>Set the <code>DEMO_CODEC_WM8962</code> macro to <code>0</code> in the <code>app_definitions.h</code> file</li>
<li>Set the <code>DEMO_CODEC_CS42448</code> macro to <code>1</code> in the <code>app_definitions.h</code> file.</li>
</ol>
</li>
<li><em>Note:</em><ul>
<li>The audio stream is as follows:<ul>
<li>Stereo INPUT 1 (J12) -&gt; LINE 1&amp;2 OUTPUT (J6)</li>
<li>Stereo INPUT 2 (J15) -&gt; LINE 3&amp;4 OUTPUT (J7)</li>
<li>MIC1 &amp; MIC2 (P1, P2) -&gt; LINE 5&amp;6 OUTPUT (J8)</li>
<li>Insert the headphones into the different line outputs to hear the inputs.</li>
<li>To use the Stereo INPUT 1, 2, connect an audio source LINE IN jack.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><b>Enable VoiceSeeker:</b><ul>
<li>On some development boards the VoiceSeeker is enabled by default, see the <a class="el" href="#maestro-record-overview">table</a> above.</li>
<li>If more than one channel is used and VIT is enabled, the VoiceSeeker that combines multiple channels into one must be used, as VIT can only work with mono signal.</li>
<li>It is necessary to add <code>VOICE_SEEKER_PROC</code> symbol to preprocessor defines on project level:<ul>
<li>(Project -&gt; Properties -&gt; C/C++ Build -&gt; Settings -&gt; MCU C Compiler -&gt; Preprocessor)</li>
</ul>
</li>
</ul>
</li>
<li><b>Enable VIT:</b><ul>
<li><em>LPCXpresso55s69:</em><ol type="1">
<li>Remove <code>SD_ENABLED</code> and <code>STREAMER_ENABLE_FILE_SINK</code> symbols from preprocessor defines on project level.</li>
<li>Add <code>VIT_PROC</code> symbol to preprocessor defines on project level:<ul>
<li>(Project -&gt; Properties -&gt; C/C++ Build -&gt; Settings -&gt; MCU C Compiler -&gt; Preprocessor)</li>
</ul>
</li>
<li>Change the <code>DEMO_MIC_CHANNEL_NUM</code> symbol value from <code>2</code> to <code>1</code> in the <code>app_definitions.h</code> file</li>
</ol>
</li>
</ul>
</li>
<li><b>VIT model generation:</b><ul>
<li>For custom VIT model generation (defining own wake words and voice commands) please use <a href="https://vit.nxp.com/">https://vit.nxp.com/</a></li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="maestro-record-functionality"></a>
Functionality</h1>
<p>The <code>record_mic</code> or <code>opus_encode</code> command calls the <code>STREAMER_mic_Create</code> or <code>STREAMER_opusmem2mem_Create</code> function from the <code>app_streamer.c</code> file depending on the selected mode.</p>
<ul>
<li>When the <em>Loopback</em> mode is selected, the command calls the <code>STREAMER_mic_Create</code> function that creates a pipeline with the following elements:<ul>
<li>ELEMENT_MICROPHONE_INDEX</li>
<li>ELEMENT_SPEAKER_INDEX</li>
</ul>
</li>
<li>When the <em>File recording</em> mode is selected, the command calls the <code>STREAMER_mic_Create</code> function that creates a pipeline with the following elements:<ul>
<li>ELEMENT_MICROPHONE_INDEX</li>
<li>ELEMENT_FILE_SINK_INDEX</li>
</ul>
</li>
<li>When the <em>Voice control</em> mode is selected, the command calls the <code>STREAMER_mic_Create</code> function that creates a pipeline with the following elements:<ul>
<li>ELEMENT_MICROPHONE_INDEX</li>
<li>ELEMENT_VOICESEEKER_INDEX (If <code>VOICE_SEEKER_PROC</code> is defined)</li>
<li>ELEMENT_VIT_INDEX</li>
</ul>
</li>
<li>When the Encoding mode is selected, the command calls the <code>STREAMER_opusmem2mem_Create</code> function that creates a pipeline with the following elements:<ul>
<li>ELEMENT_MEM_SRC_INDEX</li>
<li>ELEMENT_ENCODER_INDEX</li>
<li>ELEMENT_MEM_SINK_INDEX</li>
</ul>
</li>
</ul>
<p>Recording itself can be started with the <code>STREAMER_Start</code> function.</p>
<p>Each of the elements has several properties that can be accessed using the <code>streamer_get_property</code> or <code>streamer_set_property</code> function. These properties allow a user to change the values of the appropriate elements. The list of properties can be found in <code><a class="el" href="streamer__element__properties_8h.html" title="Header for streamer element properties.">streamer_element_properties.h</a></code>. See the example of setting property value in the following piece of code from the <code>app_streamer.c</code> file:</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structELEMENT__PROPERTY__T.html">ELEMENT_PROPERTY_T</a> prop;</div>
<div class="line"> </div>
<div class="line">prop.<a class="code hl_variable" href="structELEMENT__PROPERTY__T.html#a40dc39f13a8d25b45d19d63498082e10">prop</a> = PROP_MICROPHONE_SET_NUM_CHANNELS;</div>
<div class="line">prop.<a class="code hl_variable" href="structELEMENT__PROPERTY__T.html#ab1013a8983adf70b4cffba4637ad1df8">val</a>  = DEMO_MIC_CHANNEL_NUM;</div>
<div class="line"><a class="code hl_function" href="streamer__api_8h.html#af0f2ba1e35082e033d66b106438b51e8">streamer_set_property</a>(handle-&gt;streamer, 0, prop, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">prop.<a class="code hl_variable" href="structELEMENT__PROPERTY__T.html#a40dc39f13a8d25b45d19d63498082e10">prop</a> = PROP_MICROPHONE_SET_BITS_PER_SAMPLE;</div>
<div class="line">prop.<a class="code hl_variable" href="structELEMENT__PROPERTY__T.html#ab1013a8983adf70b4cffba4637ad1df8">val</a>  = DEMO_AUDIO_BIT_WIDTH;</div>
<div class="line"><a class="code hl_function" href="streamer__api_8h.html#af0f2ba1e35082e033d66b106438b51e8">streamer_set_property</a>(handle-&gt;streamer, 0, prop, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">prop.<a class="code hl_variable" href="structELEMENT__PROPERTY__T.html#a40dc39f13a8d25b45d19d63498082e10">prop</a> = PROP_MICROPHONE_SET_FRAME_MS;</div>
<div class="line">prop.<a class="code hl_variable" href="structELEMENT__PROPERTY__T.html#ab1013a8983adf70b4cffba4637ad1df8">val</a>  = DEMO_MIC_FRAME_SIZE;</div>
<div class="line"><a class="code hl_function" href="streamer__api_8h.html#af0f2ba1e35082e033d66b106438b51e8">streamer_set_property</a>(handle-&gt;streamer, 0, prop, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">prop.<a class="code hl_variable" href="structELEMENT__PROPERTY__T.html#a40dc39f13a8d25b45d19d63498082e10">prop</a> = PROP_MICROPHONE_SET_SAMPLE_RATE;</div>
<div class="line">prop.<a class="code hl_variable" href="structELEMENT__PROPERTY__T.html#ab1013a8983adf70b4cffba4637ad1df8">val</a>  = DEMO_AUDIO_SAMPLE_RATE;</div>
<div class="line"><a class="code hl_function" href="streamer__api_8h.html#af0f2ba1e35082e033d66b106438b51e8">streamer_set_property</a>(handle-&gt;streamer, 0, prop, <span class="keyword">true</span>);</div>
<div class="ttc" id="astreamer__api_8h_html_af0f2ba1e35082e033d66b106438b51e8"><div class="ttname"><a href="streamer__api_8h.html#af0f2ba1e35082e033d66b106438b51e8">streamer_set_property</a></div><div class="ttdeci">int32_t streamer_set_property(STREAMER_T *streamer, int8_t pipeline_id, ELEMENT_PROPERTY_T prop, bool block)</div><div class="ttdoc">Set element property.</div><div class="ttdef"><b>Definition</b> streamer.c:785</div></div>
<div class="ttc" id="astructELEMENT__PROPERTY__T_html"><div class="ttname"><a href="structELEMENT__PROPERTY__T.html">ELEMENT_PROPERTY_T</a></div><div class="ttdoc">Element Property structure.</div><div class="ttdef"><b>Definition</b> streamer_api.h:570</div></div>
<div class="ttc" id="astructELEMENT__PROPERTY__T_html_a40dc39f13a8d25b45d19d63498082e10"><div class="ttname"><a href="structELEMENT__PROPERTY__T.html#a40dc39f13a8d25b45d19d63498082e10">ELEMENT_PROPERTY_T::prop</a></div><div class="ttdeci">uint16_t prop</div><div class="ttdoc">property type</div><div class="ttdef"><b>Definition</b> streamer_api.h:571</div></div>
<div class="ttc" id="astructELEMENT__PROPERTY__T_html_ab1013a8983adf70b4cffba4637ad1df8"><div class="ttname"><a href="structELEMENT__PROPERTY__T.html#ab1013a8983adf70b4cffba4637ad1df8">ELEMENT_PROPERTY_T::val</a></div><div class="ttdeci">uintptr_t val</div><div class="ttdoc">property value</div><div class="ttdef"><b>Definition</b> streamer_api.h:572</div></div>
</div><!-- fragment --><p> Some of the predefined values can be found in the <code><a class="el" href="streamer__api_8h.html" title="Streamer API header. Public APIs for using the maestro streamer framework.">streamer_api.h</a></code>.</p>
<h1><a class="anchor" id="maestro-record-states"></a>
States</h1>
<p>The application can be in 2 different states:</p><ul>
<li>Idle</li>
<li>Running</li>
</ul>
<h1><a class="anchor" id="maestro-record-commands-in-detail"></a>
Commands in detail</h1>
<ul>
<li><a class="el" href="#maestro-record-help-version">help, version</a></li>
<li><a class="el" href="#maestro-record-record-mic-audio">record_mic audio &lt;time&gt;</a></li>
<li><a class="el" href="#maestro-record-record-mic-file">record_mic file &lt;time&gt;</a></li>
<li><a class="el" href="#maestro-record-record-mic-file">record_mic &lt;file_name&gt; &lt;time&gt;</a></li>
<li><a class="el" href="#maestro-record-record-mic-vit">record_mic vit &lt;time&gt; &lt;language&gt;</a></li>
<li><a class="el" href="#maestro-record-opus_encode">opus_encode</a></li>
</ul>
<p>Legend for diagrams:  <div class="mermaid"> 
   flowchart TD
    classDef function fill:#c6d22c
    classDef condition fill:#7cb2de
    classDef state fill:#fcb415
    classDef error fill:#FF999C

    A((State)):::state
    B{Condition}:::condition
    C[Error message]:::error
    D[Process function]:::function  
  </div> </p>
<h2><a class="anchor" id="maestro-record-help-version"></a>
help, version</h2>
<p> <div class="mermaid"> 
   flowchart TD
    classDef function fill:#c6d22c
    classDef condition fill:#7cb2de
    classDef state fill:#fcb415
    classDef error fill:#FF999C

    A((Idle)):::state --> C[Write help or version]:::function
    B((Running)):::state --> C
    C --> E((No state
    change)):::state  
  </div> </p>
<h2><a class="anchor" id="maestro-record-record-mic-audio"></a>
record_mic audio &lt;time&gt;</h2>
<p> <div class="mermaid"> 
   flowchart TD
    classDef function fill:#c6d22c
    classDef condition fill:#7cb2de
    classDef state fill:#fcb415
    classDef error fill:#FF999C

    B((Idle)):::state --> D{time
    > 0 ?}:::condition
    D -- Yes --> F[recording]:::function
    D -- No --> E[Error: Record length
    must be greater than 0]:::error
    E --> B
    F --> C((Running)):::state
    C -->G{time
    expired?}:::condition
    G -- No --> C
    G -- Yes --> B
  
  </div> </p>
<h2><a class="anchor" id="maestro-record-record-mic-file"></a>
record_mic file &lt;time&gt; ; record_mic &lt;file_name&gt; &lt;time&gt;</h2>
<p> <div class="mermaid"> 
   flowchart TD
    classDef function fill:#c6d22c
    classDef condition fill:#7cb2de
    classDef state fill:#fcb415
    classDef error fill:#FF999C

    B((Idle)):::state --> C{time
    > 0 ?}:::condition
    C -- Yes --> D{SD card
    inserted?}:::condition
    C -- No --> E[Error: Record length
    must be greater than 0]:::error
    E --> B
    D -- Yes --> G{Custom
    file name?}:::condition
    G -- Yes --> H[Create custom
    file name]:::function
    G -- No --> I[Create default
    file name]:::function
    H --> J[Recording]:::function
    I --> J
    J --> K((Running)):::state
    K -->L{time
    expired?}:::condition
    L -- No --> K
    L -- Yes --> B
    D -- No --> F[Error: Insert SD
    card first]:::error
    F --> B
  
  </div> </p>
<h2><a class="anchor" id="maestro-record-record-mic-vit"></a>
record_mic vit &lt;time&gt; &lt;language&gt;</h2>
<p> <div class="mermaid"> 
   flowchart TD
    classDef function fill:#c6d22c
    classDef condition fill:#7cb2de
    classDef state fill:#fcb415
    classDef error fill:#FF999C

    B((Idle)):::state --> C{time
    > 0 ?}:::condition
    C -- Yes --> E{Selected
    language?}:::condition
    C -- No --> D[Error: Record length
    must be greater than 0]:::error
    D --> B
    E -- Yes --> G{Supported
    language?}:::condition
    E -- No --> F[Error: Language
    not selected]:::error
    F -->B
    G -- Yes -->I[Recording with
    voice recognition]:::function
    G -- No -->H[Error: Language not supported]:::error
    H --> B
    I --> J((Running)):::state
    J -->K{time
    expired?}:::condition
    K -- No --> J
    K -- Yes --> B
  
  </div> </p>
<h2><a class="anchor" id="maestro-record-opus_encode"></a>
opus_encode</h2>
<p> <div class="mermaid"> 
   flowchart TD
    classDef function fill:#c6d22c
    classDef condition fill:#7cb2de
    classDef state fill:#fcb415
    classDef error fill:#FF999C

    B((Idle)):::state -->C[Encode file]:::function
    C -->D[Check result]:::function
    D -->B  
  </div> </p>
<h1><a class="anchor" id="maestro-record-processing-time"></a>
Processing Time</h1>
<p>Typical execution times of the streamer pipeline for the EVKC-MIMXRT1060 development board are detailed in the following table. The duration spent on output buffers and reading from the microphone is excluded from traversal measurements. Three measured pipelines were considered. The first involves a loopback from microphone to speaker, supporting both mono and stereo configurations. The second pipeline is a mono voice control setup, comprising microphone and VIT blocks. The final pipeline is a stereo voice control setup, integrating microphone, voice seeker, and VIT blocks.</p>
<p>For further details of execution times on individual elements, please refer to the <a class="el" href="md_processing__time.html">Processing Time</a> document.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone">streamer    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">microphone -&gt; speaker 1 channel   </td><td class="markdownTableBodyNone">40 &mu;s    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">microphone -&gt; speaker 2 channels   </td><td class="markdownTableBodyNone">115 &mu;s    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">microphone -&gt; VIT   </td><td class="markdownTableBodyNone">7.4 ms    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">microphone -&gt; voice seeker -&gt; VIT   </td><td class="markdownTableBodyNone">9.9 ms   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.5-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul class="foot">
    <li class="footer">&copy; 2020 NXP Semiconductors. All rights reserved.
    </li>
  </ul>
</div>
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<script>
  mermaid.initialize({
    startOnLoad: true,
    theme: 'base',
    themeVariables: {
      primaryColor: '#f4f4ff',
      secondaryColor: 'rgba(244,244,255,0.9)',
      tertiaryColor: '#F9FAFC',
    },
  });
</script>
</body>
</html>
