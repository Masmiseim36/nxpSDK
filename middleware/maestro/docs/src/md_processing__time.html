<!-- HTML header for doxygen 1.10.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Maestro Audio Framework: Processing Time</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="new_stylesheet.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="fs_logo.svg"/></td>
  <td id="projectalign">
   <div id="projectname">Maestro Audio Framework<span id="projectnumber">&#160;v 1.7</span>
   </div>
   <div id="projectbrief">NXP Semiconductors</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md_processing__time.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Processing Time</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md67"></a> </p>
<h1><a class="anchor" id="autotoc_md68"></a>
Table of content</h1>
<ul>
<li><a class="el" href="#maestro-playback-times">Maestro playback example</a></li>
<li><a class="el" href="#maestro-record-times">Maestro record example</a></li>
</ul>
<p>The individual time measurements were conducted using a logic analyzer by monitoring changes in the GPIO port levels on the EVKC-MIMXRT1060 development board. These measurements were executed for each individual pipeline run, capturing the timing at each corresponding element, and, when relevant, the interconnections between these elements.</p>
<h1><a class="anchor" id="maestro-playback-times"></a>
Maestro playback example</h1>
<p>For the Maestro playback example the following reference audio file was used: <a href="test_48khz_16bit_2ch.wav">test_48khz_16bit_2ch.wav</a>. In this example, the pipeline depicted in the diagram was considered. Media codecs WAV and MP3 were taken into account. To compare the times spent on the SSRC block, sampling rates for both codecs were selected: 44.1 kHz and 48 kHz.</p>
<div class="image">
<object type="image/svg+xml" data="playback.svg" style="pointer-events: none;"></object>
</div>
    <p>The measurement of streamer pipeline run started at the beginning of <code><a class="el" href="streamer_8c.html#ad66e6eff9e2db74dc4534d4eef780005" title="Streamer Process Pipelines.">streamer_process_pipelines()</a></code>: <code><a class="el" href="streamer_8c.html" title="Af Streamer implementation.">streamer.c</a></code> and ended in the function <code>streamer_pcm_write()</code>: <code>streamer_pcm.c</code> just before the output buffer.</p>
<p>In the scenario involving the WAV codec, the audio file was accessed in every iteration of the streamer pipeline. Meaning, during each run, the file was read directly from the SD card. However, in the case of the MP3 codec, where data processing necessitates complete MP3 frames, the file wasn't read during every run. Rather, it was accessed periodically, triggered when the codec buffer lacked a complete MP3 frame of data. The total time spent on codec processing varies significantly depending on the type and implementation of the codec. For certain types of codecs, like FLAC, there may be multiple file accesses during a single pipeline run. The provided values are specific to the reference implementation. For details about the codecs please see <a class="el" href="mp3dec_start.html#md_mp3dec">MP3 decoder</a> and <a class="el" href="md_wavdec.html">WAV decoder</a> documents.</p>
<p>The duration of the streamer pipeline illustrates that with a sampling frequency of 48 kHz, there is no resampling occurring at the SSRC element. Consequently, the overall pipeline time is lower than in the case of 44.1 kHz audio, where resampling takes place.</p>
<p>To enhance comprehension of the system's behavior, histograms of the pipeline run times and its elements are included. The greater time variance with the MP3 codec is precisely due to the absence of file reads in every run. In clusters with shorter times, there are no file accesses, while in clusters with longer times, file reads occur. This indicates that the majority of runs do not involve file access.</p>
<p><br  />
</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone">WAV 48 kHz   </th><th class="markdownTableHeadNone">WAV 44 kHz   </th><th class="markdownTableHeadNone">MP3 48 kHz file read   </th><th class="markdownTableHeadNone">MP3 48 kHz w/o file read   </th><th class="markdownTableHeadNone">MP3 44 kHz file read   </th><th class="markdownTableHeadNone">MP3 44 kHz w/o file read    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">mean   </td><td class="markdownTableBodyNone">1.11 ms   </td><td class="markdownTableBodyNone">1.76 ms   </td><td class="markdownTableBodyNone">2.87 ms   </td><td class="markdownTableBodyNone">0.51 ms   </td><td class="markdownTableBodyNone">3.22 ms   </td><td class="markdownTableBodyNone">0.89 ms    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">min   </td><td class="markdownTableBodyNone">1.03 ms   </td><td class="markdownTableBodyNone">1.60 ms   </td><td class="markdownTableBodyNone">2.74 ms   </td><td class="markdownTableBodyNone">0.41 ms   </td><td class="markdownTableBodyNone">2.33 ms   </td><td class="markdownTableBodyNone">0.74 ms    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">max   </td><td class="markdownTableBodyNone">1.29 ms   </td><td class="markdownTableBodyNone">2.23 ms   </td><td class="markdownTableBodyNone">3.24 ms   </td><td class="markdownTableBodyNone">1.83 ms   </td><td class="markdownTableBodyNone">3.73 ms   </td><td class="markdownTableBodyNone">1.12 ms   </td></tr>
</table>
<p><br  />
</p>
<div class="image">
<object type="image/svg+xml" data="playback_streamer2.svg" style="pointer-events: none;"></object>
</div>
    <p><br  />
</p>
<h2><a class="anchor" id="autotoc_md69"></a>
Time on each element</h2>
<p>In the tables and histograms below, the timings for individual elements and their connections are provided. Given that the file reading function was invoked during the codec's operation, the tables for individual elements display the total time on the codec element, the time on the codec element before the file read, and the time on the codec element after the file read. The individual blocks in the tables are as follows:</p>
<ul>
<li><b>streamer</b> - total time of one pipeline run without time on output buffers</li>
<li><b>codec start</b> - time on decoder before file read</li>
<li><b>codec end</b> - time on decoder after file read</li>
<li><b>codec total</b> - codec_start+codec_end</li>
<li><b>file_src</b> - file reading time</li>
<li><b>SSRC_proc</b> - time on SSRC element</li>
<li><b>audio_sink</b> - time on audio sink without ouput buffers</li>
<li><b>pcm_write</b> - time on output buffers</li>
<li><b>link</b> - time on element links</li>
</ul>
<p>The start times of the time intervals for individual blocks and their respective links were measured by altering the GPIO pin level in the following functions:</p>
<ul>
<li><b>streamer</b> - <code><a class="el" href="streamer_8c.html#ad66e6eff9e2db74dc4534d4eef780005" title="Streamer Process Pipelines.">streamer_process_pipelines()</a></code>:<code><a class="el" href="streamer_8c.html" title="Af Streamer implementation.">streamer.c</a></code></li>
<li><b>codec</b> - <code><a class="el" href="decoder__pads_8c.html#a157b06f13d9b90241c9ce5a0d6c05ba4" title="decoder_sink_pad_process_handler">decoder_sink_pad_process_handler()</a></code>:<code><a class="el" href="decoder__pads_8c.html" title="This file contains the pad functions used in the decoder element. These functions are wrappers that c...">decoder_pads.c</a></code></li>
<li><b>file_src</b> - <code><a class="el" href="file__src__freertos_8c.html#a4928ae0fbcf3dcb8e0ff19ae32e6e310" title="Function reads the data from the file specified by the element. NOTE: Function may or may not be able...">filesrc_read()</a></code>:<code>file_src_rtos.c</code></li>
<li><b>SSRC_proc</b> - <code>SSRC_Proc_Execute()</code>:<code>ssrc_proc.c</code></li>
<li><b>audio_sink</b> - <code><a class="el" href="audio__sink_8c.html#a23917902e681056411525dbf8451620d" title="This pad function accumulates data from the decoder and pushes it onto the selected audio driver....">audiosink_sink_pad_chain_handler()</a></code>:<code><a class="el" href="audio__sink_8c.html" title="This file contains the audio sink element implementation.">audio_sink.c</a></code></li>
<li><b>pcm_write</b> - <code>streamer_pcm_write()</code>:<code>streamer_pcm.c</code></li>
<li><b>link</b> - <code><a class="el" href="pad_8c.html#a82a7214418489f587607e71c957ff341" title="Push the data buffer to the peer pad.">pad_push()</a></code>:<code><a class="el" href="pad_8c.html" title="This file contains the streamer element pad implementation.">pad.c</a></code></li>
</ul>
<p><br  />
</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">WAV 48kHz   </th><th class="markdownTableHeadNone">streamer   </th><th class="markdownTableHeadNone">codec total   </th><th class="markdownTableHeadNone">codec start   </th><th class="markdownTableHeadNone">file_src   </th><th class="markdownTableHeadNone">codec end   </th><th class="markdownTableHeadNone">link codec-SSRC   </th><th class="markdownTableHeadNone">SSRC_proc   </th><th class="markdownTableHeadNone">link SSRC-audio_sink   </th><th class="markdownTableHeadNone">audio_sink   </th><th class="markdownTableHeadNone">pcm_write    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">mean   </td><td class="markdownTableBodyNone">1.119 ms   </td><td class="markdownTableBodyNone">152 &mu;s   </td><td class="markdownTableBodyNone">31 &mu;s   </td><td class="markdownTableBodyNone">0.843 ms   </td><td class="markdownTableBodyNone">120 &mu;s   </td><td class="markdownTableBodyNone">5 &mu;s   </td><td class="markdownTableBodyNone">64 &mu;s   </td><td class="markdownTableBodyNone">2 &mu;s   </td><td class="markdownTableBodyNone">40 &mu;s   </td><td class="markdownTableBodyNone">20.228 ms    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">min   </td><td class="markdownTableBodyNone">1.026 ms   </td><td class="markdownTableBodyNone">125 &mu;s   </td><td class="markdownTableBodyNone">21 &mu;s   </td><td class="markdownTableBodyNone">0.773 ms   </td><td class="markdownTableBodyNone">104 &mu;s   </td><td class="markdownTableBodyNone">&lt;1 &mu;s   </td><td class="markdownTableBodyNone">47 &mu;s   </td><td class="markdownTableBodyNone">&lt;1 &mu;s   </td><td class="markdownTableBodyNone">30 &mu;s   </td><td class="markdownTableBodyNone">19.805 ms    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">max   </td><td class="markdownTableBodyNone">1.290 ms   </td><td class="markdownTableBodyNone">193 &mu;s   </td><td class="markdownTableBodyNone">49 &mu;s   </td><td class="markdownTableBodyNone">1.311 ms   </td><td class="markdownTableBodyNone">144 &mu;s   </td><td class="markdownTableBodyNone">23 &mu;s   </td><td class="markdownTableBodyNone">93 &mu;s   </td><td class="markdownTableBodyNone">14 &mu;s   </td><td class="markdownTableBodyNone">91 &mu;s   </td><td class="markdownTableBodyNone">20.324 ms   </td></tr>
</table>
<p><br  />
</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">WAV 44kHz   </th><th class="markdownTableHeadNone">streamer   </th><th class="markdownTableHeadNone">codec total   </th><th class="markdownTableHeadNone">codec start   </th><th class="markdownTableHeadNone">file_src   </th><th class="markdownTableHeadNone">codec end   </th><th class="markdownTableHeadNone">link codec-SSRC   </th><th class="markdownTableHeadNone">SSRC_proc   </th><th class="markdownTableHeadNone">link SSRC-audio_sink   </th><th class="markdownTableHeadNone">audio_sink   </th><th class="markdownTableHeadNone">pcm_write    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">mean   </td><td class="markdownTableBodyNone">1.765 ms   </td><td class="markdownTableBodyNone">178 &mu;s   </td><td class="markdownTableBodyNone">44 &mu;s   </td><td class="markdownTableBodyNone">0.853 ms   </td><td class="markdownTableBodyNone">134 &mu;s   </td><td class="markdownTableBodyNone">5 &mu;s   </td><td class="markdownTableBodyNone">671 &mu;s   </td><td class="markdownTableBodyNone">3 &mu;s   </td><td class="markdownTableBodyNone">42 &mu;s   </td><td class="markdownTableBodyNone">21.472 ms    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">min   </td><td class="markdownTableBodyNone">1.604 ms   </td><td class="markdownTableBodyNone">145 &mu;s   </td><td class="markdownTableBodyNone">33 &mu;s   </td><td class="markdownTableBodyNone">0.770 ms   </td><td class="markdownTableBodyNone">112 &mu;s   </td><td class="markdownTableBodyNone">&lt;1 &mu;s   </td><td class="markdownTableBodyNone">574 &mu;s   </td><td class="markdownTableBodyNone">&lt;1 &mu;s   </td><td class="markdownTableBodyNone">33 &mu;s   </td><td class="markdownTableBodyNone">18.163 ms    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">max   </td><td class="markdownTableBodyNone">2.233 ms   </td><td class="markdownTableBodyNone">218 &mu;s   </td><td class="markdownTableBodyNone">57 &mu;s   </td><td class="markdownTableBodyNone">1.335 ms   </td><td class="markdownTableBodyNone">161 &mu;s   </td><td class="markdownTableBodyNone">18 &mu;s   </td><td class="markdownTableBodyNone">715 &mu;s   </td><td class="markdownTableBodyNone">5 &mu;s   </td><td class="markdownTableBodyNone">89 &mu;s   </td><td class="markdownTableBodyNone">21.746 ms   </td></tr>
</table>
<p><br  />
</p>
<p><img src="wav_48kHz.svg" alt="" style="pointer-events: none;" class="inline"/>    </p>
<p><img src="wav_44kHz.svg" alt="" style="pointer-events: none;" class="inline"/>    </p>
<p><br  />
</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">MP3 48 kHz w/ file read   </th><th class="markdownTableHeadNone">streamer   </th><th class="markdownTableHeadNone">codec total   </th><th class="markdownTableHeadNone">codec start   </th><th class="markdownTableHeadNone">file_src   </th><th class="markdownTableHeadNone">codec end   </th><th class="markdownTableHeadNone">link codec-SSRC   </th><th class="markdownTableHeadNone">SSRC_proc   </th><th class="markdownTableHeadNone">link SSRC-audio_sink   </th><th class="markdownTableHeadNone">audio_sink   </th><th class="markdownTableHeadNone">pcm_write    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">mean   </td><td class="markdownTableBodyNone">2.871 ms   </td><td class="markdownTableBodyNone">441 &mu;s   </td><td class="markdownTableBodyNone">279 &mu;s   </td><td class="markdownTableBodyNone">2.271 ms   </td><td class="markdownTableBodyNone">162 &mu;s   </td><td class="markdownTableBodyNone">6 &mu;s   </td><td class="markdownTableBodyNone">56 &mu;s   </td><td class="markdownTableBodyNone">3 &mu;s   </td><td class="markdownTableBodyNone">50 &mu;s   </td><td class="markdownTableBodyNone">11.019 ms    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">min   </td><td class="markdownTableBodyNone">2.739 ms   </td><td class="markdownTableBodyNone">353 &mu;s   </td><td class="markdownTableBodyNone">74 &mu;s   </td><td class="markdownTableBodyNone">1.353 ms   </td><td class="markdownTableBodyNone">26 &mu;s   </td><td class="markdownTableBodyNone">&lt;1 &mu;s   </td><td class="markdownTableBodyNone">40 &mu;s   </td><td class="markdownTableBodyNone">&lt;1 &mu;s   </td><td class="markdownTableBodyNone">34 &mu;s   </td><td class="markdownTableBodyNone">10.091 ms    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">max   </td><td class="markdownTableBodyNone">3.244 ms   </td><td class="markdownTableBodyNone">570 &mu;s   </td><td class="markdownTableBodyNone">409 &mu;s   </td><td class="markdownTableBodyNone">2.728 ms   </td><td class="markdownTableBodyNone">467 &mu;s   </td><td class="markdownTableBodyNone">18 &mu;s   </td><td class="markdownTableBodyNone">80 &mu;s   </td><td class="markdownTableBodyNone">14 &mu;s   </td><td class="markdownTableBodyNone">62 &mu;s   </td><td class="markdownTableBodyNone">12.910 ms   </td></tr>
</table>
<p><br  />
</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">MP3 48 kHz w/o file read   </th><th class="markdownTableHeadNone">streamer   </th><th class="markdownTableHeadNone">codec total   </th><th class="markdownTableHeadNone">codec start   </th><th class="markdownTableHeadNone">file_src   </th><th class="markdownTableHeadNone">codec end   </th><th class="markdownTableHeadNone">link codec-SSRC   </th><th class="markdownTableHeadNone">SSRC_proc   </th><th class="markdownTableHeadNone">link SSRC-audio_sink   </th><th class="markdownTableHeadNone">audio_sink   </th><th class="markdownTableHeadNone">pcm_write    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">mean   </td><td class="markdownTableBodyNone">0.508 ms   </td><td class="markdownTableBodyNone">403 &mu;s   </td><td class="markdownTableBodyNone">x   </td><td class="markdownTableBodyNone">x   </td><td class="markdownTableBodyNone">x   </td><td class="markdownTableBodyNone">8 &mu;s   </td><td class="markdownTableBodyNone">39 &mu;s   </td><td class="markdownTableBodyNone">3 &mu;s   </td><td class="markdownTableBodyNone">36 &mu;s   </td><td class="markdownTableBodyNone">11.326 ms    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">min   </td><td class="markdownTableBodyNone">0.407 ms   </td><td class="markdownTableBodyNone">208 &mu;s   </td><td class="markdownTableBodyNone">x   </td><td class="markdownTableBodyNone">x   </td><td class="markdownTableBodyNone">x   </td><td class="markdownTableBodyNone">&lt;1 &mu;s   </td><td class="markdownTableBodyNone">25 &mu;s   </td><td class="markdownTableBodyNone">&lt;1 &mu;s   </td><td class="markdownTableBodyNone">21 &mu;s   </td><td class="markdownTableBodyNone">7.715 ms    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">max   </td><td class="markdownTableBodyNone">1.834 ms   </td><td class="markdownTableBodyNone">563 &mu;s   </td><td class="markdownTableBodyNone">x   </td><td class="markdownTableBodyNone">x   </td><td class="markdownTableBodyNone">x   </td><td class="markdownTableBodyNone">41 &mu;s   </td><td class="markdownTableBodyNone">69 &mu;s   </td><td class="markdownTableBodyNone">16 &mu;s   </td><td class="markdownTableBodyNone">104 &mu;s   </td><td class="markdownTableBodyNone">12.941 ms   </td></tr>
</table>
<p><br  />
</p>
<p><img src="mp3_48kHz_with_fileread.svg" alt="" style="pointer-events: none;" class="inline"/>    </p>
<p><img src="mp3_48kHz_without_fileread.svg" alt="" style="pointer-events: none;" class="inline"/>    </p>
<p><br  />
</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">MP3 44 kHz w/ file read   </th><th class="markdownTableHeadNone">streamer   </th><th class="markdownTableHeadNone">codec total   </th><th class="markdownTableHeadNone">codec start   </th><th class="markdownTableHeadNone">file_src   </th><th class="markdownTableHeadNone">codec end   </th><th class="markdownTableHeadNone">link codec-SSRC   </th><th class="markdownTableHeadNone">SSRC_proc   </th><th class="markdownTableHeadNone">link SSRC-audio_sink   </th><th class="markdownTableHeadNone">audio_sink   </th><th class="markdownTableHeadNone">pcm_write    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">mean   </td><td class="markdownTableBodyNone">3.217 ms   </td><td class="markdownTableBodyNone">436 &mu;s   </td><td class="markdownTableBodyNone">367 &mu;s   </td><td class="markdownTableBodyNone">2.300 ms   </td><td class="markdownTableBodyNone">66 &mu;s   </td><td class="markdownTableBodyNone">7 &mu;s   </td><td class="markdownTableBodyNone">403 &mu;s   </td><td class="markdownTableBodyNone">3 &mu;s   </td><td class="markdownTableBodyNone">51 &mu;s   </td><td class="markdownTableBodyNone">12.188 ms    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">min   </td><td class="markdownTableBodyNone">2.329 ms   </td><td class="markdownTableBodyNone">383 &mu;s   </td><td class="markdownTableBodyNone">73 &mu;s   </td><td class="markdownTableBodyNone">1.411 ms   </td><td class="markdownTableBodyNone">26 &mu;s   </td><td class="markdownTableBodyNone">2 &mu;s   </td><td class="markdownTableBodyNone">318 &mu;s   </td><td class="markdownTableBodyNone">&lt;1 &mu;s   </td><td class="markdownTableBodyNone">35 &mu;s   </td><td class="markdownTableBodyNone">9.119 ms    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">max   </td><td class="markdownTableBodyNone">3.726 ms   </td><td class="markdownTableBodyNone">547 &mu;s   </td><td class="markdownTableBodyNone">464 &mu;s   </td><td class="markdownTableBodyNone">2.801 ms   </td><td class="markdownTableBodyNone">441 &mu;s   </td><td class="markdownTableBodyNone">27 &mu;s   </td><td class="markdownTableBodyNone">454 &mu;s   </td><td class="markdownTableBodyNone">12 &mu;s   </td><td class="markdownTableBodyNone">65 &mu;s   </td><td class="markdownTableBodyNone">12.529 ms   </td></tr>
</table>
<p><br  />
</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">MP3 44 kHz w/o file read   </th><th class="markdownTableHeadNone">streamer   </th><th class="markdownTableHeadNone">codec total   </th><th class="markdownTableHeadNone">codec start   </th><th class="markdownTableHeadNone">file_src   </th><th class="markdownTableHeadNone">codec end   </th><th class="markdownTableHeadNone">link codec-SSRC   </th><th class="markdownTableHeadNone">SSRC_proc   </th><th class="markdownTableHeadNone">link SSRC-audio_sink   </th><th class="markdownTableHeadNone">audio_sink   </th><th class="markdownTableHeadNone">pcm_write    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">mean   </td><td class="markdownTableBodyNone">0.891 ms   </td><td class="markdownTableBodyNone">437 &mu;s   </td><td class="markdownTableBodyNone">x   </td><td class="markdownTableBodyNone">x   </td><td class="markdownTableBodyNone">x   </td><td class="markdownTableBodyNone">9 &mu;s   </td><td class="markdownTableBodyNone">388 &mu;s   </td><td class="markdownTableBodyNone">3 &mu;s   </td><td class="markdownTableBodyNone">38 &mu;s   </td><td class="markdownTableBodyNone">11.934 ms    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">min   </td><td class="markdownTableBodyNone">0.738 ms   </td><td class="markdownTableBodyNone">268 &mu;s   </td><td class="markdownTableBodyNone">x   </td><td class="markdownTableBodyNone">x   </td><td class="markdownTableBodyNone">x   </td><td class="markdownTableBodyNone">&lt;1 &mu;s   </td><td class="markdownTableBodyNone">290 &mu;s   </td><td class="markdownTableBodyNone">&lt;1 &mu;s   </td><td class="markdownTableBodyNone">22 &mu;s   </td><td class="markdownTableBodyNone">8.964 ms    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">max   </td><td class="markdownTableBodyNone">1.115 ms   </td><td class="markdownTableBodyNone">620 &mu;s   </td><td class="markdownTableBodyNone">x   </td><td class="markdownTableBodyNone">x   </td><td class="markdownTableBodyNone">x   </td><td class="markdownTableBodyNone">45 &mu;s   </td><td class="markdownTableBodyNone">438 &mu;s   </td><td class="markdownTableBodyNone">17 &mu;s   </td><td class="markdownTableBodyNone">92 &mu;s   </td><td class="markdownTableBodyNone">12.624 ms   </td></tr>
</table>
<p><br  />
</p>
<p><img src="mp3_44kHz_with_fileread.svg" alt="" style="pointer-events: none;" class="inline"/>    </p>
<p><img src="mp3_44kHz_without_fileread.svg" alt="" style="pointer-events: none;" class="inline"/>    </p>
<h1><a class="anchor" id="maestro-record-times"></a>
Maestro record example</h1>
<p>Typical execution times of the streamer pipeline and its individual elements for the EVKC-MIMXRT1060 development board are detailed in the following tables. The duration spent on output buffers and reading from the microphone is excluded from traversal measurements. Three measured pipelines are depicted in the figure below. The first involves a loopback from microphone to speaker, supporting both mono and stereo configurations. The second pipeline is a mono voice control setup, comprising microphone and VIT blocks. The final pipeline is a stereo voice control setup, integrating microphone, voice seeker, and VIT blocks. The measurement of streamer pipeline run started at the beginning of <code><a class="el" href="streamer_8c.html#ad66e6eff9e2db74dc4534d4eef780005" title="Streamer Process Pipelines.">streamer_process_pipelines()</a></code>:<code><a class="el" href="streamer_8c.html" title="Af Streamer implementation.">streamer.c</a></code> and ended in the function <code>streamer_pcm_write()</code>: <code>streamer_pcm.c</code> just before the output buffer.</p>
<div class="image">
<object type="image/svg+xml" data="record.svg" style="pointer-events: none;"></object>
</div>
    <p><br  />
</p>
<div class="image">
<object type="image/svg+xml" data="record_streamer2.svg" style="pointer-events: none;"></object>
</div>
    <p>The individual blocks in the tables are as follows:</p>
<ul>
<li><b>streamer</b> - total time of one pipeline run without time on output buffers and without time reading from the microphone</li>
<li><b>audio_src_start</b> - time on audio src before reading from the microphone</li>
<li><b>audio_src_end</b> - time on audio src after reading from the microphone</li>
<li><b>pcm_read</b> - reading from the microphone</li>
<li><b>voiceseeker</b> - time on voice seeker element</li>
<li><b>vit</b> - time on VIT element</li>
<li><b>audio_sink</b> - time on audio sink without ouput buffers</li>
<li><b>pcm_write</b> - time on output buffers</li>
<li><b>link</b> - time on element links</li>
</ul>
<p>The start times of the time intervals for individual blocks and their respective links were measured by altering the GPIO pin level in the following functions:</p>
<ul>
<li><b>streamer</b> - <code><a class="el" href="streamer_8c.html#ad66e6eff9e2db74dc4534d4eef780005" title="Streamer Process Pipelines.">streamer_process_pipelines()</a></code>:<code><a class="el" href="streamer_8c.html" title="Af Streamer implementation.">streamer.c</a></code></li>
<li><b>audio_src</b> - <code><a class="el" href="audio__src_8c.html#aa07d4d9104141fe28711628147054dcc" title="Function is the loop function of the audiosrc source pad which runs in the task thread....">audiosrc_src_process()</a></code>:<code><a class="el" href="audio__src_8c.html" title="This file implement audio source.">audio_src.c</a></code></li>
<li><b>pcm_read</b> - <code>streamer_pcm_read()</code>:<code>streamer_pcm.c</code></li>
<li><b>voiceseeker</b> - <code><a class="el" href="audio__proc_8c.html#a45ae88cef2424da539d70364b532fe24" title="This pad function takes data from the source element and pushes it onto the AUDIO_PROC library.">audio_proc_sink_pad_chain_handler()</a></code>:<code><a class="el" href="audio__proc_8c.html" title="This file contains the implementation for the AudioProc integration.">audio_proc.c</a></code></li>
<li><b>vit</b> - <code><a class="el" href="vit__sink_8c.html#ab86f5934a4b4bac5d4b0f968e56efdeb" title="This pad function takes data from the source element and pushes it onto the VIT library....">vitsink_sink_pad_chain_handler()</a></code>:<code><a class="el" href="vit__sink_8c.html" title="This file contains the implementation for the Vit Sink.">vit_sink.c</a></code></li>
<li><b>audio_sink</b> - <code><a class="el" href="audio__sink_8c.html#a23917902e681056411525dbf8451620d" title="This pad function accumulates data from the decoder and pushes it onto the selected audio driver....">audiosink_sink_pad_chain_handler()</a></code>:<code><a class="el" href="audio__sink_8c.html" title="This file contains the audio sink element implementation.">audio_sink.c</a></code></li>
<li><b>pcm_write</b> - <code>streamer_pcm_write()</code>:<code>streamer_pcm.c</code></li>
<li><b>link</b> - <code><a class="el" href="pad_8c.html#a82a7214418489f587607e71c957ff341" title="Push the data buffer to the peer pad.">pad_push()</a></code>:<code><a class="el" href="pad_8c.html" title="This file contains the streamer element pad implementation.">pad.c</a></code></li>
</ul>
<h2><a class="anchor" id="autotoc_md70"></a>
Pipeline Microphone -&gt; Speaker</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">microphone -&gt; speaker mono   </th><th class="markdownTableHeadNone">streamer   </th><th class="markdownTableHeadNone">audio_src_start   </th><th class="markdownTableHeadNone">pcm_read   </th><th class="markdownTableHeadNone">audio_src_end   </th><th class="markdownTableHeadNone">link audio_src-audio_sink   </th><th class="markdownTableHeadNone">audio_sink   </th><th class="markdownTableHeadNone">pcm_write    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">mean   </td><td class="markdownTableBodyNone">43 &mu;s   </td><td class="markdownTableBodyNone">3 &mu;s   </td><td class="markdownTableBodyNone">29.938 ms   </td><td class="markdownTableBodyNone">29 &mu;s   </td><td class="markdownTableBodyNone">&lt;1 &mu;s   </td><td class="markdownTableBodyNone">10 &mu;s   </td><td class="markdownTableBodyNone">18 &mu;s    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">min   </td><td class="markdownTableBodyNone">26 &mu;s   </td><td class="markdownTableBodyNone">&lt;1 &mu;s   </td><td class="markdownTableBodyNone">29.350 ms   </td><td class="markdownTableBodyNone">19 &mu;s   </td><td class="markdownTableBodyNone">&lt;1 &mu;s   </td><td class="markdownTableBodyNone">5 &mu;s   </td><td class="markdownTableBodyNone">12 &mu;s    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">max   </td><td class="markdownTableBodyNone">72 &mu;s   </td><td class="markdownTableBodyNone">12 &mu;s   </td><td class="markdownTableBodyNone">29.957 ms   </td><td class="markdownTableBodyNone">44 &mu;s   </td><td class="markdownTableBodyNone">1 &mu;s   </td><td class="markdownTableBodyNone">15 &mu;s   </td><td class="markdownTableBodyNone">25 &mu;s   </td></tr>
</table>
<p><br  />
</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">microphone -&gt; speaker stereo   </th><th class="markdownTableHeadNone">streamer   </th><th class="markdownTableHeadNone">audio_src_start   </th><th class="markdownTableHeadNone">pcm_read   </th><th class="markdownTableHeadNone">audio_src_end   </th><th class="markdownTableHeadNone">link audio_src-audio_sink   </th><th class="markdownTableHeadNone">audio_sink   </th><th class="markdownTableHeadNone">pcm_write    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">mean   </td><td class="markdownTableBodyNone">115 &mu;s   </td><td class="markdownTableBodyNone">5 &mu;s   </td><td class="markdownTableBodyNone">29.861 ms   </td><td class="markdownTableBodyNone">54 &mu;s   </td><td class="markdownTableBodyNone">2 &mu;s   </td><td class="markdownTableBodyNone">55 &mu;s   </td><td class="markdownTableBodyNone">23 &mu;s    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">min   </td><td class="markdownTableBodyNone">94 &mu;s   </td><td class="markdownTableBodyNone">&lt;1 &mu;s   </td><td class="markdownTableBodyNone">29.768 ms   </td><td class="markdownTableBodyNone">43 &mu;s   </td><td class="markdownTableBodyNone">&lt;1 &mu;s   </td><td class="markdownTableBodyNone">50 &mu;s   </td><td class="markdownTableBodyNone">12 &mu;s    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">max   </td><td class="markdownTableBodyNone">154 &mu;s   </td><td class="markdownTableBodyNone">14 &mu;s   </td><td class="markdownTableBodyNone">29.880 ms   </td><td class="markdownTableBodyNone">67 &mu;s   </td><td class="markdownTableBodyNone">8 &mu;s   </td><td class="markdownTableBodyNone">65 &mu;s   </td><td class="markdownTableBodyNone">49 &mu;s   </td></tr>
</table>
<p><br  />
</p>
<p><img src="mic_speaker_1ch_elements_without_fileread.svg" alt="" style="pointer-events: none;" class="inline"/>    </p>
<p><img src="mic_speaker_2ch_elements_without_fileread.svg" alt="" style="pointer-events: none;" class="inline"/>    </p>
<h2><a class="anchor" id="autotoc_md71"></a>
Pipeline Microphone -&gt; VIT</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">microphone -&gt; VIT   </th><th class="markdownTableHeadNone">streamer   </th><th class="markdownTableHeadNone">audio_src_start   </th><th class="markdownTableHeadNone">pcm_read   </th><th class="markdownTableHeadNone">audio_src_end   </th><th class="markdownTableHeadNone">link audio_src-vit   </th><th class="markdownTableHeadNone">vit    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">mean   </td><td class="markdownTableBodyNone">7.380 ms   </td><td class="markdownTableBodyNone">30 &mu;s   </td><td class="markdownTableBodyNone">22.624 ms   </td><td class="markdownTableBodyNone">78 &mu;s   </td><td class="markdownTableBodyNone">2 &mu;s   </td><td class="markdownTableBodyNone">7.261 ms    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">min   </td><td class="markdownTableBodyNone">2.641 ms   </td><td class="markdownTableBodyNone">10 &mu;s   </td><td class="markdownTableBodyNone">2.2265 ms   </td><td class="markdownTableBodyNone">58 &mu;s   </td><td class="markdownTableBodyNone">&lt;1 &mu;s   </td><td class="markdownTableBodyNone">2.559 ms    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">max   </td><td class="markdownTableBodyNone">7.780 ms   </td><td class="markdownTableBodyNone">42 &mu;s   </td><td class="markdownTableBodyNone">2.7341 ms   </td><td class="markdownTableBodyNone">94 &mu;s   </td><td class="markdownTableBodyNone">5 &mu;s   </td><td class="markdownTableBodyNone">7.624 ms   </td></tr>
</table>
<p><br  />
</p>
<div class="image">
<object type="image/svg+xml" data="mic_vit_elements.svg" style="pointer-events: none;"></object>
</div>
    <h2><a class="anchor" id="autotoc_md72"></a>
Pipeline Microphone -&gt; Voice seeker -&gt; VIT</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">microphone -&gt; voice seeker -&gt; VIT   </th><th class="markdownTableHeadNone">streamer   </th><th class="markdownTableHeadNone">audio_src_start   </th><th class="markdownTableHeadNone">pcm_read   </th><th class="markdownTableHeadNone">audio_src_end   </th><th class="markdownTableHeadNone">link audio_src-voiceseeker   </th><th class="markdownTableHeadNone">voiceseeker   </th><th class="markdownTableHeadNone">link voiceseeker-vit   </th><th class="markdownTableHeadNone">vit    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">mean   </td><td class="markdownTableBodyNone">9.916 ms   </td><td class="markdownTableBodyNone">22 &mu;s   </td><td class="markdownTableBodyNone">20.084 ms   </td><td class="markdownTableBodyNone">84 &mu;s   </td><td class="markdownTableBodyNone">4 &mu;s   </td><td class="markdownTableBodyNone">2.386 ms   </td><td class="markdownTableBodyNone">13 &mu;s   </td><td class="markdownTableBodyNone">7.407 ms    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">min   </td><td class="markdownTableBodyNone">4.983 ms   </td><td class="markdownTableBodyNone">19 &mu;s   </td><td class="markdownTableBodyNone">19.738 ms   </td><td class="markdownTableBodyNone">72 &mu;s   </td><td class="markdownTableBodyNone">&lt;1 &mu;s   </td><td class="markdownTableBodyNone">2.228 ms   </td><td class="markdownTableBodyNone">2 &mu;s   </td><td class="markdownTableBodyNone">2.662 ms    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">max   </td><td class="markdownTableBodyNone">10.423 ms   </td><td class="markdownTableBodyNone">34 &mu;s   </td><td class="markdownTableBodyNone">24.777 ms   </td><td class="markdownTableBodyNone">100 &mu;s   </td><td class="markdownTableBodyNone">7 &mu;s   </td><td class="markdownTableBodyNone">2.522 ms   </td><td class="markdownTableBodyNone">31 &mu;s   </td><td class="markdownTableBodyNone">7.729 ms   </td></tr>
</table>
<p><br  />
</p>
<div class="image">
<object type="image/svg+xml" data="mic_vs_vit_elements.svg" style="pointer-events: none;"></object>
</div>
     </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.5-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul class="foot">
    <li class="footer">&copy; 2020 NXP Semiconductors. All rights reserved.
    </li>
  </ul>
</div>
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<script>
  mermaid.initialize({
    startOnLoad: true,
    theme: 'base',
    themeVariables: {
      primaryColor: '#f4f4ff',
      secondaryColor: 'rgba(244,244,255,0.9)',
      tertiaryColor: '#F9FAFC',
    },
  });
</script>
</body>
</html>
