<!DOCTYPE html>
<html style="text-align: center;">     
  <head>       
    <meta http-equiv="content-type" content="text/html; charset=windows-1250">       
    <meta name="generator" content="PSPad editor, www.pspad.com">       
    <title>    
    </title>       
    <link href="style.css" rel="stylesheet" type="text/css" />      
    <script type="text/javascript" src="JS_functions\mainInclude.js"></script>
    <script LANGUAGE="JavaScript" type ="text/javascript">
      includeJSfiles();
    </script>
     
   </head>     
   <body  id="CLoop" onload="innerHTMLonload(); initLoadFormCloop()" background="images/background.png" style="display: inline-block; margin: 10px auto; text-align: center;">                                          
    <OBJECT id="MCB_PC_Master_Services1" style="display:none;" classid="clsid:48A185F1-FFDB-11D3-80E3-00C04F176153" name="pcm">	     
    </OBJECT>	     
     
    <OBJECT style="display:none;" CLASSID = "clsid:5220cb21-c88d-11cf-b347-00aa00a28331">         
      <PARAM NAME="LPKPath" VALUE="gmsctls.lpk">         
    </OBJECT>  
    <!-- Headline -->
    <div class="HeadBorder fontTitle" style="width: 740px;">Current Control Loop</div>  
    
    <div>              
      <table style="width: 740px;" class="MainTab" >               
        <tr>                 
            <td width="40%" align="left" valign="top" style="padding-right: 15px;">                      		                            
            <!-- current controller input parameters-->     
              <fieldset  style="width: 100%;" class="ContBox">
                <legend class="fontControlLabel">Currrent Loop Parameters</legend>        
                <table id="inParameterTable" width="100%"  border="0"   class="ContBoxTab" >            
                              
                <script>
    	            // current control loop sampling period
                  document.write( build_parameter_line( "Sample&nbsp;Time","CLOOP_Ts", "sec", "Current control loop sampling period, typical range <50;200>us", 0, ""));
                  // current control loop bandwidth
                  document.write( build_parameter_line( "f<sub>0,Current</sub>","CLOOP_F0", "Hz", "Current control loop bandwidth, typical range <100;350>Hz", 0, ""));
                  // current control loop attenuation
                  document.write( build_parameter_line( "&xi;","CLOOP_Att", "-", "Current control loop attenuation, typical range <0.707;2>", 0, ""));
                </script>	
                
                </table>
                <table width="100%"  border="0"   class="ContBoxTab" >            
                            
                <script>
                    document.write( build_informative_line("Ccontroller","PI controller type", "Parallel"));                   
                </script>
           
                </table>
              </fieldset> 
              <!-- current controller limits-->
              <fieldset style="width: 100%;"  class="ContBox">     
                <legend class="fontControlLabel">Current PI Controller Limits</legend>        
                <table id="parameterTable" border="0" width="100%"  class="ContBoxTab"  >            
                        
                  <script>
                  // current controller limits
                  document.write( build_parameter_line("Output&nbsp;limit", "CLOOP_LIM", "%", "Limit of current loop in percentage of filtered DC-Bus voltage", 0, ""));
                  </script>	
               </table>
              </fieldset>
              

             </td>                            
            <td width="30%" align="center" valign="top" style="padding-right: 10px;">                                                 
              <!-- D-axis parameters-->   
              <fieldset id="Daxis_PIparal" style="width: 100%; "  class="ContBox">
                  <legend class="fontControlLabel" >D axis PI Controller</legend>        
                <table id="parameterTable"  width="100%" class="ContBoxTab">            
                  <script>
                    // D-axis controller proportional gain and gain scales
                    document.write( build_constant_line("K<sub>P</sub>","D_Kp_g", "d-axis PI discrete controller proportional gain"));
                    document.write( build_constant_line("K<sub>I</sub>","D_Ki_g", "d-axis PI discrete controller integral gain"));
                   </script>	
               </table>
              </fieldset> 
              <fieldset  id="Daxis_PIrecur" style="width: 100%; display: none;"  class="ContBox">
                <legend class="fontControlLabel">D axis PI Controller</legend>        
                <table id="parameterTable"  width="100%"  class="ContBoxTab">            
                    
                  <script>                 
                    // D-axis controller proportional gain and gain scales
                    document.write( build_constant_line("D_CC1","D_CC1", "d-axis controller CC1 constant in Z domain"));
                    document.write( build_constant_line("D_CC2","D_CC2", "d-axis controller CC2 constant in Z domain"));                 
                 </script>	
                                        
               </table>
              </fieldset>
              <!-- D-axis ZC constants-->   
              <fieldset id="Daxis_ZC" style="width: 100%; display: none;"  class="ContBox">
                <legend class="fontControlLabel">D axis ZC Constants</legend>        
                <table id="parameterTableQ"   width="100%"  class="ContBoxTab">            
                  <script>
    	          document.write( build_constant_line("D_B0", "D_ZC_B0", "d-axis zero cancelation filter constant B0"));
                  document.write( build_constant_line("D_B1", "D_ZC_B1", "d-axis zero cancelation filter constant B1"));
                  document.write( build_constant_line("D_A1", "D_ZC_A1", "d-axis zero cancelation filter constant A1"));
                  </script>	
                                       
               </table>
              </fieldset> 
             </td>	
            <td width="30%" align="right" valign="top" style="padding-left: 10px;">                                                 
              <!-- Q-axis parameters-->   
              <fieldset  id="Qaxis_PIparal" style="width: 100%;" class="ContBox">
                <legend class="fontControlLabel">Q axis PI Controller</legend>        
                <table id="parameterTable"   width="100%"  class="ContBoxTab">            
                     
                  <script>
    	            // Q-axis controller proportional gain and gain scales 
                  document.write( build_constant_line("K<sub>P</sub>","Q_Kp_g", "q-axis discrete PI controller proportional gain"));
                  document.write( build_constant_line("K<sub>I</sub>","Q_Ki_g", "q-axis discrete PI controller integral gain"));
                  </script>	
                                        
               </table>
              </fieldset> 
              <fieldset  id="Qaxis_PIrecur" style="width: 100%; " class="ContBox">
                <legend class="fontControlLabel">Q axis PI Controller</legend>        
                <table id="parameterTable"   width="100%"  class="ContBoxTab">            
                      
                  <script>      
                  // Q-axis controller proportional gain and gain scales 
                  document.write( build_constant_line("Q_CC1","Q_CC1", "q-axis PI controller CC1 constant in Z domain"));
                  document.write( build_constant_line("Q_CC2","Q_CC2", "q-axis PI controller CC2 constant in Z domain"));
                  </script>	
            	                            
               </table>
              </fieldset> 
              <!-- Q-axis ZC constants-->   
              <fieldset id="Qaxis_ZC" style="width: 100%;" class="ContBox">
                <legend class="fontControlLabel">Q axis ZC Constants</legend>        
                <table id="parameterTable"   width="100%"  class="ContBoxTab">            
                       
                  <script>
    	          document.write( build_constant_line("Q_B0", "Q_ZC_B0", "q-axis zero cancelation filter constant B0"));
                  document.write( build_constant_line("Q_B1", "Q_ZC_B1", "q-axis zero cancelation filter constant B1"));
                  document.write( build_constant_line("Q_A1", "Q_ZC_A1", "q-axis zero cancelation filter constant A1"));
                  </script>	
                                          
               </table>
              </fieldset>
             </td>
        </tr>         
      </table>                      
      <table class = "fButtonGroup" >                     
            <tr>  
                <td><input type="button" class="fButtonsEnabled" value="Update Target" id="CurrUpdateFrm" onmouseout="unmarkUpdateCLField()" onmouseover="markUpdateCLField()" onclick="clickUpdateCloopFM()" /></td> 
                <td><input type="button" class="fButtonsDisabled" value="Reload Data" id="ReloadData" onclick="clickReloadData(); initLoadFormCloop();" disabled="disabled" /></td> 
                <td><input type="button" class="fButtonsDisabled" value="Store Data" id="StoreData" onclick="clickStoreData()" disabled="disabled" /></td> 
            </tr>            
      </table>   
        
     <span style="visibility: hidden;" face="sans-serif" id="txtErrMsg">       
      </span>  
      
    </div>     
  </body>
</html>