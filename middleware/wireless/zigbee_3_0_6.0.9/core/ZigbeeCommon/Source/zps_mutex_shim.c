/*
* Copyright 2016-2017 NXP
* All rights reserved.
*
* SPDX-License-Identifier: BSD-3-Clause
*/

/*!=============================================================================
\file       zps_mutex_shim.c
\brief      provides the wrapper functions for ZPS Mutex
==============================================================================*/

/****************************************************************************/
/***        Include files                                                 ***/
/****************************************************************************/
#include "jendefs.h"
#include "fsl_os_abstraction.h"
/****************************************************************************/
/***        Macro Definitions                                             ***/
/****************************************************************************/

/****************************************************************************/
/***        Type Definitions                                              ***/
/****************************************************************************/

/****************************************************************************/
/***        Imported Function Prototypes                                  ***/
/****************************************************************************/


/****************************************************************************/
/***        Exported Variables                                            ***/
/****************************************************************************/

/****************************************************************************/
/***        Local Variables                                               ***/
/****************************************************************************/
osaMutexId_t zpsMutexId = NULL;
/****************************************************************************/
/***        Exported Functions                                            ***/
/****************************************************************************/

/****************************************************************************
 *
 * NAME: ZPS_u8GrabMutexLock
 *
 * DESCRIPTION:
 * Lock ZPS mutex, if this is the first call then create mutex and save
 *
 * PARAMETERS:      Name            RW  Usage
 *
 *
 * RETURNS:
 * None.
 *
 * NOTES:
 * None.
 ****************************************************************************/

uint8 ZPS_u8GrabMutexLock( void* hMutex , void* psIntStore )
{
    if(NULL == zpsMutexId)
    {
        zpsMutexId = OSA_MutexCreate();
        if(NULL == zpsMutexId)
        {
            return osaStatus_Error;
        }
    }
    return OSA_MutexLock(zpsMutexId, 0);
}

/****************************************************************************
 *
 * NAME: ZPS_u8ReleaseMutexLock
 *
 * DESCRIPTION:
 *
 *
 * PARAMETERS:      Name            RW  Usage
 * None
 *
 * RETURNS:
 * None
 *
 * NOTES:
 *
 ****************************************************************************/

uint8 ZPS_u8ReleaseMutexLock( void* hMutex , void* psIntStore )
{
    return OSA_MutexUnlock(zpsMutexId);
}

/****************************************************************************/
/***        END OF FILE                                                   ***/
/****************************************************************************/

